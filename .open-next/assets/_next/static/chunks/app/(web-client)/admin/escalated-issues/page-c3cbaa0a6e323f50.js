(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8584],{11048:(e,s,t)=>{Promise.resolve().then(t.bind(t,51106))},51106:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>d});var a=t(95155),r=t(12115),i=t(26681);function l(e){let{isAdmin:s=!1}=e,[t,l]=(0,r.useState)([]),[d,n]=(0,r.useState)(!0),[c,o]=(0,r.useState)(null),[x,u]=(0,r.useState)("OPEN");(0,r.useEffect)(()=>{m()},[x]);let m=async()=>{try{n(!0);let e=await fetch("/api/escalation?action=by-status&status=".concat(x)),s=await e.json();s.success?l(s.issues):o(s.error||"Failed to fetch escalated issues")}catch(e){o("Failed to fetch escalated issues"),console.error("Error fetching escalated issues:",e)}finally{n(!1)}},h=async(e,s,t)=>{try{let a=await fetch("/api/escalation",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"update",id:e,status:s,resolutionNotes:t})}),r=await a.json();r.success?m():o(r.error||"Failed to update issue")}catch(e){o("Failed to update issue"),console.error("Error updating issue:",e)}},g=e=>{switch(e){case"OPEN":return"bg-red-100 text-red-800";case"IN_PROGRESS":return"bg-yellow-100 text-yellow-800";case"RESOLVED":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},p=e=>{switch(e){case"payment_issue":return"bg-purple-100 text-purple-800";case"technical_problem":return"bg-blue-100 text-blue-800";case"user_frustration":return"bg-orange-100 text-orange-800";case"safety_concern":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return s?(0,a.jsxs)("div",{className:"p-6 max-w-7xl mx-auto",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Escalated Issues Dashboard"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Monitor and manage issues escalated from AI chat interactions"})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("label",{htmlFor:"status-filter",className:"block text-sm font-medium text-gray-700 mb-2",children:"Filter by Status"}),(0,a.jsxs)("select",{id:"status-filter",value:x,onChange:e=>u(e.target.value),className:"block w-full max-w-xs rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[(0,a.jsx)("option",{value:"OPEN",children:"Open"}),(0,a.jsx)("option",{value:"IN_PROGRESS",children:"In Progress"}),(0,a.jsx)("option",{value:"RESOLVED",children:"Resolved"}),(0,a.jsx)("option",{value:"CLOSED",children:"Closed"})]})]}),c&&(0,a.jsx)("div",{className:"mb-6 bg-red-50 border border-red-200 rounded-lg p-4",children:(0,a.jsx)("p",{className:"text-red-800",children:c})}),d&&(0,a.jsx)("div",{className:"flex justify-center items-center py-8",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}),!d&&0===t.length&&(0,a.jsx)("div",{className:"text-center py-8",children:(0,a.jsxs)("p",{className:"text-gray-500",children:['No escalated issues found with status "',x,'"']})}),!d&&t.length>0&&(0,a.jsx)("div",{className:"space-y-4",children:t.map(e=>(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[(0,a.jsx)("div",{className:"flex items-start justify-between mb-4",children:(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(g(e.status)),children:e.status}),(0,a.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(p(e.issueType)),children:e.issueType.replace("_"," ")})]}),(0,a.jsxs)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:["Issue #",e.id.slice(0,8)]}),(0,a.jsx)("p",{className:"text-gray-600 mb-2",children:e.description}),(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:[(0,a.jsxs)("p",{children:["User ID: ",e.userId]}),e.gigId&&(0,a.jsxs)("p",{children:["Gig ID: ",e.gigId]}),(0,a.jsxs)("p",{children:["Created: ",(0,i.GP)(new Date(e.createdAt),"PPP p")]}),(0,a.jsxs)("p",{children:["Updated: ",(0,i.GP)(new Date(e.updatedAt),"PPP p")]})]})]})}),e.resolutionNotes&&(0,a.jsxs)("div",{className:"mb-4 p-3 bg-gray-50 rounded-md",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-1",children:"Resolution Notes"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.resolutionNotes})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:["OPEN"===e.status&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>h(e.id,"IN_PROGRESS"),className:"px-3 py-1 text-sm bg-yellow-600 text-white rounded hover:bg-yellow-700",children:"Start Working"}),(0,a.jsx)("button",{onClick:()=>h(e.id,"RESOLVED"),className:"px-3 py-1 text-sm bg-green-600 text-white rounded hover:bg-green-700",children:"Mark Resolved"})]}),"IN_PROGRESS"===e.status&&(0,a.jsx)("button",{onClick:()=>h(e.id,"RESOLVED"),className:"px-3 py-1 text-sm bg-green-600 text-white rounded hover:bg-green-700",children:"Mark Resolved"}),"RESOLVED"===e.status&&(0,a.jsx)("button",{onClick:()=>h(e.id,"CLOSED"),className:"px-3 py-1 text-sm bg-gray-600 text-white rounded hover:bg-gray-700",children:"Close Issue"})]})]},e.id))}),(0,a.jsx)("div",{className:"mt-6",children:(0,a.jsx)("button",{onClick:m,className:"px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700",children:"Refresh"})})]}):(0,a.jsx)("div",{className:"p-6",children:(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[(0,a.jsx)("h3",{className:"text-red-800 font-medium",children:"Access Denied"}),(0,a.jsx)("p",{className:"text-red-600",children:"You don't have permission to view this dashboard."})]})})}function d(){return(0,a.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto py-6",children:(0,a.jsx)(l,{isAdmin:!0})})})}}},e=>{var s=s=>e(e.s=s);e.O(0,[6681,8441,1684,7358],()=>s(11048)),_N_E=e.O()}]);