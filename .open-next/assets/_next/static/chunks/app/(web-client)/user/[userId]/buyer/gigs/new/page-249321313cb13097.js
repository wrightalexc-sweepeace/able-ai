(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4423],{15774:e=>{e.exports={cssVariables:"page_cssVariables__067qW",container:"page_container__6FKJ1",fadeIn:"page_fadeIn__atVjk",finalSubmitButton:"page_finalSubmitButton__zr5Hc",loadingContainer:"page_loadingContainer__BVM43",workerCard:"page_workerCard__sfSnr",workerImage:"page_workerImage__qdXmu",workerInfo:"page_workerInfo__gTFyr",bookButton:"page_bookButton__23GDl"}},19946:(e,t,n)=>{"use strict";n.d(t,{A:()=>p});var i=n(12115);let o=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),r=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()),a=e=>{let t=r(e);return t.charAt(0).toUpperCase()+t.slice(1)},s=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((e,t,n)=>!!e&&""!==e.trim()&&n.indexOf(e)===t).join(" ").trim()},l=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var c={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let d=(0,i.forwardRef)((e,t)=>{let{color:n="currentColor",size:o=24,strokeWidth:r=2,absoluteStrokeWidth:a,className:d="",children:p,iconNode:u,...g}=e;return(0,i.createElement)("svg",{ref:t,...c,width:o,height:o,stroke:n,strokeWidth:a?24*Number(r)/Number(o):r,className:s("lucide",d),...!p&&!l(g)&&{"aria-hidden":"true"},...g},[...u.map(e=>{let[t,n]=e;return(0,i.createElement)(t,n)}),...Array.isArray(p)?p:[p]])}),p=(e,t)=>{let n=(0,i.forwardRef)((n,r)=>{let{className:l,...c}=n;return(0,i.createElement)(d,{ref:r,iconNode:t,className:s("lucide-".concat(o(a(e))),"lucide-".concat(e),l),...c})});return n.displayName=a(e),n}},34477:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{callServer:function(){return i.callServer},createServerReference:function(){return r},findSourceMapURL:function(){return o.findSourceMapURL}});let i=n(53806),o=n(31818),r=n(34979).createServerReference},66766:(e,t,n)=>{"use strict";n.d(t,{default:()=>o.a});var i=n(71469),o=n.n(i)},67689:(e,t,n)=>{Promise.resolve().then(n.bind(n,78953))},71469:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{default:function(){return l},getImageProps:function(){return s}});let i=n(88229),o=n(38883),r=n(33063),a=i._(n(51193));function s(e){let{props:t}=(0,o.getImgProps)(e,{defaultLoader:a.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,n]of Object.entries(t))void 0===n&&delete t[e];return{props:t}}let l=r.Image},78953:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>T});var i=n(95155),o=n(12115),r=n(35695),a=n(66766),s=n(85189),l=n(42474),c=n(23646),d=n(14477),p=n(81403),u=n.n(p);let g=e=>{let{sessionCode:t,onConfirm:n,role:r}=e,[a,s]=(0,o.useState)("edit"),[c,d]=(0,o.useState)(""),[p,g]=(0,o.useState)(!1);(0,o.useEffect)(()=>{t&&!p&&(s("view"),d(t))},[t,p]);let f=e=>{p||(g(!0),n((null==e?void 0:e.trim().toUpperCase())||null))};return(0,i.jsx)(l.A,{text:(()=>{if(p){let e=c.trim().toUpperCase();return(0,i.jsx)("div",{className:u().confirmedMessage,children:e?'Discount code "'.concat(e,'" applied.'):"No discount code applied."})}return"view"===a&&t?(0,i.jsxs)("div",{children:[(0,i.jsxs)("p",{className:u().promptTextLargeMargin,children:["We found a referral code: ",(0,i.jsx)("strong",{children:t})]}),(0,i.jsxs)("div",{className:u().buttonContainer,children:[(0,i.jsx)("button",{className:"".concat(u().bubbleButton," ").concat(u().primary),onClick:()=>f(t),children:"Use this code"}),(0,i.jsx)("button",{className:"".concat(u().bubbleButton," ").concat(u().secondary),onClick:()=>{s("edit"),d("")},children:"Enter another"})]})]}):(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:u().promptText,children:"Do you have a different discount code? Enter it below or skip."}),(0,i.jsx)("input",{type:"text",value:c,onChange:e=>d(e.target.value),placeholder:"e.g., ABLE20",className:u().codeInput}),(0,i.jsxs)("div",{className:u().buttonContainer,children:[(0,i.jsx)("button",{className:"".concat(u().bubbleButton," ").concat(u().primary),onClick:()=>f(c),children:"Apply Code"}),(0,i.jsx)("button",{className:"".concat(u().bubbleButton," ").concat(u().secondary),onClick:()=>f(null),children:"Skip"})]})]})})(),senderType:"bot",role:r,showAvatar:!0})};var f=n(51078),m=n(15774),y=n.n(m),h=n(25731),b=n(34477);let x=(0,b.createServerReference)("409db384ffd03d5c2f3d4a3cf8d9092ddbfb8cb6b9",b.callServer,void 0,b.findSourceMapURL,"createGig");var v=n(72260),w=n(85004),S=n(76294);let j=[{name:"gigDescription",type:"text",placeholder:"e.g., Bartender for a wedding reception",defaultPrompt:"Tell me about yourself and what gig or gigs you need filling!",rows:3},{name:"additionalInstructions",type:"text",placeholder:"e.g., Cocktail making experience would be ideal",defaultPrompt:"Do you need any special skills or do you have instructions for your hire?",rows:3},{name:"hourlyRate",type:"number",placeholder:"\xa315",defaultPrompt:"How much would you like to pay per hour?"},{name:"gigLocation",type:"location",defaultPrompt:"Where is the gig located?"},{name:"gigDate",type:"date",defaultPrompt:"What date is the gig?"},{name:"gigTime",type:"time",defaultPrompt:"What time does the gig start?"},{name:"discountCode",type:"text",placeholder:"e.g., ABLE20",defaultPrompt:"Great! Just one last thing. Do you have a discount code to apply? \uD83C\uDF9F️ If not, no worries!"}];async function C(e,t,n){try{let i=S.Sj.object({properties:{prompt:S.Sj.string()}}),o='You are Able, a GIG CREATION ASSISTANT. Your ONLY job is to help users create gig listings (job postings) on a gig platform. You are NOT a general assistant, therapist, or friend. You ONLY help with gig creation.\n\nCRITICAL: This is a GIG CREATION FLOW. The user is creating a job posting to hire someone for work. They are the BUYER/EMPLOYER posting a job. You are helping them create a gig listing.\n\nPrevious conversation context:\nGig Description: "'.concat(t,'"\n\nNext field to ask about: "').concat(e,"\"\n\nGenerate a friendly, contextual prompt for the next question. The prompt should:\n1. Be conversational and natural - avoid repetitive phrases like \"Awesome, a [gig type] gig!\"\n2. Reference what they've already shared about their gig in a fresh way\n3. Be specific to the field being asked about\n4. Include relevant emojis to make it engaging\n5. Provide helpful context or examples when appropriate\n6. Vary your language - don't start every message the same way\n7. ALWAYS stay focused on gig creation - this is for creating a job posting\n\nField-specific guidance:\n- additionalInstructions: Ask about specific skills, requirements, or preferences for the job\n- hourlyRate: Ask about budget with relevant pricing guidance for hiring someone in British Pounds (\xa3)\n- gigLocation: Ask about location with context about finding nearby workers\n- gigDate: Ask about timing with context about availability\n- gigTime: Ask about the specific start time of the gig\n\nGIG CREATION CONTEXT: Remember, this user is creating a job posting to hire someone. They are the employer/buyer. Keep responses focused on gig creation only.\n\nBe creative and natural in your responses. Don't repeat the same phrases or structure. Make each message feel fresh and conversational."),r=await (0,v.rL)("gemini-2.0-flash",{prompt:o,responseSchema:i,isStream:!1},n);if(r.ok)return r.data.prompt}catch(e){console.error("AI prompt generation failed:",e)}return"Tell me more about your ".concat(e,"! I'm here to help you create the perfect gig listing! ✨")}S.Sj.object({properties:{field:S.Sj.string(),prompt:S.Sj.string(),isComplete:S.Sj.boolean()}}),S.Sj.object({properties:{gigDescription:S.Sj.string(),additionalInstructions:S.Sj.string(),hourlyRate:S.Sj.number(),gigLocation:S.Sj.string(),gigDate:S.Sj.string(),gigTime:S.Sj.string(),discountCode:S.Sj.string(),selectedWorker:S.Sj.string()},optionalProperties:["discountCode","selectedWorker"]});let k=()=>(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",padding:"12px 16px",color:"var(--secondary-color)",fontWeight:600,animation:"slideIn 0.3s ease-out",opacity:0,animationFillMode:"forwards"},children:[(0,i.jsxs)("div",{style:{display:"flex",gap:"4px",background:"rgba(126, 238, 249, 0.1)",padding:"8px 12px",borderRadius:"20px",border:"1px solid rgba(126, 238, 249, 0.2)"},children:[(0,i.jsx)("span",{className:"typing-dot",style:{animation:"typingBounce 1.4s infinite ease-in-out",fontSize:"18px",lineHeight:"1"},children:"●"}),(0,i.jsx)("span",{className:"typing-dot",style:{animation:"typingBounce 1.4s infinite ease-in-out 0.2s",fontSize:"18px",lineHeight:"1"},children:"●"}),(0,i.jsx)("span",{className:"typing-dot",style:{animation:"typingBounce 1.4s infinite ease-in-out 0.4s",fontSize:"18px",lineHeight:"1"},children:"●"})]}),(0,i.jsx)("style",{children:"\n      @keyframes slideIn {\n        from {\n          opacity: 0;\n          transform: translateY(10px);\n        }\n        to {\n          opacity: 1;\n          transform: translateY(0);\n        }\n      }\n      @keyframes typingBounce {\n        0%, 60%, 100% {\n          transform: translateY(0);\n          opacity: 0.4;\n        }\n        30% {\n          transform: translateY(-8px);\n          opacity: 1;\n        }\n      }\n      @keyframes slideIn {\n        from {\n          opacity: 0;\n          transform: translateY(10px);\n        }\n        to {\n          opacity: 1;\n          transform: translateY(0);\n        }\n      }\n      @keyframes typingBounce {\n        0%, 60%, 100% {\n          transform: translateY(0);\n          opacity: 0.4;\n        }\n        30% {\n          transform: translateY(-8px);\n          opacity: 1;\n        }\n      }\n    "})]});function T(){let e=(0,r.useRouter)(),{user:t}=(0,h.A)(),n=(0,o.useRef)(null),p=(0,o.useRef)(null),{ai:u}=(0,w.D)(),[m,b]=(0,o.useState)({}),[T,I]=(0,o.useState)(!1),[N,A]=(0,o.useState)(),[D,R]=(0,o.useState)(!1),[_,B]=(0,o.useState)(new Set),[P,L]=(0,o.useState)(null),[E,O]=(0,o.useState)([{id:1,type:"bot",content:"Hi! Tell me about yourself and what gig or gigs you need filling - we can assemble a team if you need one!"},{id:2,type:"input",inputConfig:{type:"text",name:"gigDescription"},isComplete:!1}]),[M,z]=(0,o.useState)({}),[Y,F]=(0,o.useState)(!1),[G,W]=(0,o.useState)(null),[U,H]=(0,o.useState)(!1),[V,J]=(0,o.useState)(new Set),[$,q]=(0,o.useState)(null);function X(e){return j.find(t=>!e[t.name])}function Z(e){try{var t,n;if(!e)return null;if("string"==typeof e){let n=e.trim(),i=n.match(/^(\d{1,2}):(\d{2})\s*[-–]\s*(\d{1,2}):(\d{2})$/);if(i){let e=parseInt(i[1],10),t=parseInt(i[2],10);if(e>=0&&e<=23&&t>=0&&t<=59)return"".concat(e.toString().padStart(2,"0"),":").concat(t.toString().padStart(2,"0"))}let o=n.match(/^(\d{1,2}):(\d{2})\s*([AaPp][Mm])\s*[-–]\s*(\d{1,2}):(\d{2})\s*([AaPp][Mm])$/);if(o){let e=parseInt(o[1],10),n=parseInt(o[2],10),i=null==(t=o[3])?void 0:t.toLowerCase();if("pm"===i&&12!==e&&(e+=12),"am"===i&&12===e&&(e=0),e>=0&&e<=23&&n>=0&&n<=59)return"".concat(e.toString().padStart(2,"0"),":").concat(n.toString().padStart(2,"0"))}}if(e instanceof Date){let t=e.getHours().toString().padStart(2,"0"),n=e.getMinutes().toString().padStart(2,"0");return"".concat(t,":").concat(n)}if("string"==typeof e){let t=e.trim();if(t.includes("T")){let e=new Date(t);if(!isNaN(e.getTime())){let t=e.getHours().toString().padStart(2,"0"),n=e.getMinutes().toString().padStart(2,"0");return"".concat(t,":").concat(n)}}let i=t.match(/^(\d{1,2}):(\d{2})\s*([AaPp][Mm])?$/);if(i){let e=parseInt(i[1],10),t=parseInt(i[2],10),o=null==(n=i[3])?void 0:n.toLowerCase();if(o&&(12===e&&(e=0),"pm"===o&&(e+=12)),e>=0&&e<=23&&t>=0&&t<=59)return"".concat(e.toString().padStart(2,"0"),":").concat(t.toString().padStart(2,"0"))}let o=t.match(/^(\d{1,2})\s*([AaPp][Mm])$/);if(o){let e=parseInt(o[1],10),t=o[2].toLowerCase();if(12===e&&(e=0),"pm"===t&&(e+=12),e>=0&&e<=23)return"".concat(e.toString().padStart(2,"0"),":00")}}}catch(e){}return null}function K(e){if(!e)return"";try{let t=Z(e);if(t){let[e,n]=t.split(":"),i=new Date;return i.setHours(parseInt(e,10),parseInt(n,10)),i.toLocaleTimeString("en-GB",{hour:"numeric",minute:"2-digit",hour12:!0})}return String(e)}catch(t){return String(e)}}async function Q(e,t,n,i){if(!t)return{sufficient:!1,clarificationPrompt:"Please provide some information so I can help you create the perfect gig listing!"};let o=String(t).trim();try{let r=S.Sj.object({properties:{isAppropriate:S.Sj.boolean(),isGigRelated:S.Sj.boolean(),isSufficient:S.Sj.boolean(),clarificationPrompt:S.Sj.string(),sanitizedValue:S.Sj.string()}}),a="You are Able, a GIG CREATION ASSISTANT. Your ONLY job is to help users create gig listings (job postings) on a gig platform. You are NOT a general assistant, therapist, or friend. You ONLY help with gig creation.\n\nCRITICAL: This is a GIG CREATION FLOW. The user is creating a job posting to hire someone for work. They are the BUYER/EMPLOYER posting a job. You are helping them create a gig listing.\n\nPrevious context from this conversation:\n".concat(Object.entries(m).filter(t=>{let[n,i]=t;return i&&n!==e}).map(e=>{let[t,n]=e;return"".concat(t,": ").concat(n)}).join(", "),'\n\nCurrent field being validated: "').concat(e,'"\nUser input: "').concat(o,'"\nInput type: "').concat(n,'"\n\nValidation criteria:\n1. isAppropriate: Check if the content is appropriate for a professional gig platform (no offensive language, profanity, or inappropriate content)\n2. isGigRelated: Check if the content is related to gig work, events, services, or job requirements (be lenient - most gig descriptions are broad)\n3. isSufficient: Check if the content provides basic information (at least 3 characters for text, valid numbers for rates, coordinates for locations)\n\nIMPORTANT: For location fields (gigLocation), coordinate objects with lat/lng properties are ALWAYS valid and sufficient. Do not ask for additional location details if coordinates are provided.\n\nSPECIAL TIME HANDLING: For time fields (gigTime), if the user provides a time range like "12PM to 4pm" or "12:00-14:30" or "12:00 PM - 2:30 PM":\n- Accept it as valid\n- In sanitizedValue, convert to 24-hour format: "12:00 to 16:00" or "12:00 to 14:30"\n- For time ranges, always use the format "HH:MM to HH:MM" in 24-hour time\n- Examples:\n  * "12PM to 4pm" → "12:00 to 16:00"\n  * "9am to 5pm" → "09:00 to 17:00"\n  * "2:30 PM to 6:30 PM" → "14:30 to 18:30"\n  * "12:00-14:30" → "12:00 to 14:30"\n- This standardized format helps with gig scheduling and display\n\nSpecial handling:\n- For coordinates (lat/lng): Accept any valid coordinate format like "Lat: 14.7127059, Lng: 120.9341704" or coordinate objects\n- For location objects: If the input is an object with lat/lng properties, accept it as valid location data\n- For numbers (hourlyRate): Accept reasonable rates (\xa35-500 per hour)\n- For text: Be lenient and accept most gig-related content\n- For dates: Accept any valid date format\n- For location fields: Accept coordinates, addresses, venue names, or any location information\n- For time fields: Accept single times (12:00, 2:30 PM) or time ranges (12:00-14:30, 12:00 PM - 2:30 PM)\n- For discountCode: This is optional. If the user provides a code, sanitize it (e.g., uppercase, remove spaces). If they say "no", "none", "skip", or leave it empty, that is PERFECTLY SUFFICIENT. The sanitizedValue should be an empty string in that case.\n\nIf validation passes, respond with:\n- isAppropriate: true\n- isGigRelated: true\n- isSufficient: true\n- clarificationPrompt: ""\n- sanitizedValue: string (cleaned version of the input, with special formatting for time ranges)\n\nIf validation fails, respond with:\n- isAppropriate: boolean\n- isGigRelated: boolean\n- isSufficient: boolean\n- clarificationPrompt: string (provide a friendly, contextual response that references what they\'ve already shared and guides them naturally)\n- sanitizedValue: string\n\nGIG CREATION CONTEXT: Remember, this user is creating a job posting to hire someone. They are the employer/buyer. Keep responses focused on gig creation only.\n\nBe conversational and reference their previous inputs when possible. For example:\n- If they mentioned "web developer" earlier: "Great! I see you need a web developer. Could you tell me more about what kind of web development skills you\'re looking for?"\n- If they mentioned "wedding": "Perfect! A wedding is such a special occasion. What specific help do you need for your wedding day?"\n- If they mentioned "restaurant": "Excellent! Restaurant work can be fast-paced and exciting. What role are you looking to fill?"\n\nMake the conversation feel natural and build on what they\'ve already told you.'),s=await (0,v.rL)("gemini-2.0-flash",{prompt:a,responseSchema:r,isStream:!1},i);if(s.ok){let n=s.data;if(!n.isAppropriate||!n.isGigRelated||!n.isSufficient)return{sufficient:!1,clarificationPrompt:n.clarificationPrompt||"Please provide appropriate gig-related information."};if(t&&"object"==typeof t&&"lat"in t&&"lng"in t)return{sufficient:!0,sanitized:t};if("gigDate"===e)try{if("string"==typeof t&&t.match(/^\d{4}-\d{2}-\d{2}$/))return{sufficient:!0,sanitized:t};if("string"==typeof t&&t.includes("T"))return{sufficient:!0,sanitized:t.split("T")[0]};if(t instanceof Date)return{sufficient:!0,sanitized:t.toISOString().split("T")[0]}}catch(e){console.error("Date validation error:",e)}if("gigTime"===e)try{let e=Z(t);if(e)return{sufficient:!0,sanitized:e}}catch(e){console.error("Time validation error:",e)}return{sufficient:!0,sanitized:n.sanitizedValue||o}}}catch(e){console.error("AI validation failed:",e)}return{sufficient:!0,sanitized:o}}async function ee(e,t,n){var i;let o=n||m[t];if(!o)return;let r=E.find(t=>t.id===e),a=(null==r||null==(i=r.inputConfig)?void 0:i.type)||"text";O(e=>[...e,{id:Date.now()+1,type:"typing",isNew:!0}]);try{let n=await Q(t,o,a,u);if(O(t=>t.filter(e=>"typing"!==e.type).map(t=>t.id===e?{...t,isComplete:!0}:t)),!n.sufficient)return void O(e=>{var i;let o=(null==r?void 0:r.type)==="location"?"location":(null==r?void 0:r.type)==="calendar"?"calendar":"input",a=null!=(i=null==r?void 0:r.inputConfig)?i:{type:"text",name:t,placeholder:""};return[...e,{id:Date.now()+2,type:"bot",content:n.clarificationPrompt,isNew:!0},{id:Date.now()+3,type:o,inputConfig:a,isComplete:!1,isNew:!0}]});if(G===t){b(e=>({...e,[t]:n.sanitized})),H(!1),W(null);let e={...m,[t]:n.sanitized},i=X(e);if(i){let t=e.gigDescription||"",n=await C(i.name,t,u),o={type:i.type,name:i.name,placeholder:i.placeholder||i.defaultPrompt,...i.rows&&{rows:i.rows}},r="input";"gigDate"===i.name?r="calendar":"gigLocation"===i.name&&(r="location"),O(e=>[...e,{id:Date.now()+3,type:"bot",content:n,isNew:!0},{id:Date.now()+4,type:r,inputConfig:o,isComplete:!1,isNew:!0}])}else O(t=>[...t,{id:Date.now()+5,type:"bot",content:"Thank you! Here is a summary of your gig:\n".concat(JSON.stringify(e,null,2)),isNew:!0}])}else O(e=>[...e,{id:Date.now()+3,type:"sanitized",fieldName:t,sanitizedValue:n.sanitized,originalValue:o,isNew:!0}]),b(e=>({...e,[t]:n.sanitized}))}catch(e){console.error("AI validation error:",e),G===t&&(H(!1),W(null)),O(e=>[...e.filter(e=>"typing"!==e.type),{id:Date.now()+2,type:"bot",content:"I'm having trouble processing that. Please try again with a clear description of your gig needs.",isNew:!0}])}}let et=e=>"gigDate"===e?"calendar":"gigLocation"===e?"location":"discountCode"===e?"discountCode":"input";async function en(e,t){let n=m[t];if(!n||D)return;R(!0),O(t=>t.map(t=>t.id===e?{...t,isComplete:!0}:t)),O(e=>[...e,{id:Date.now()+1,type:"typing",isNew:!0}]);let i={...m,[t]:n};b(i);let o=X(i);setTimeout(async()=>{if(O(e=>e.filter(e=>"typing"!==e.type)),o){let e=await C(o.name,i.gigDescription||"",u),t=et(o.name),n={type:o.type,name:o.name,placeholder:o.placeholder||o.defaultPrompt,...o.rows&&{rows:o.rows}};O(i=>[...i,{id:Date.now()+2,type:"bot",content:e,isNew:!0},{id:Date.now()+3,type:t,inputConfig:n,isComplete:!1,isNew:!0}])}else O(e=>[...e,{id:Date.now()+2,type:"bot",content:"Thank you! Here is a summary of your gig:\n".concat(JSON.stringify(i,null,2)),isNew:!0}])},700),B(t=>new Set([...t,e])),setTimeout(()=>{R(!1)},1e3)}let ei=(0,o.useCallback)(async(e,t)=>{try{H(!1),W(null),J(t=>new Set([...t,"".concat(e,"-confirm")]));let n={...m,[e]:t};b(n),O(t=>t.map(t=>"sanitized"===t.type&&t.fieldName===e?{...t,isComplete:!0}:t));let i=X(n);if(i){let e=await C(i.name,n.gigDescription||"",u),t=et(i.name),o={type:i.type,name:i.name,placeholder:i.placeholder||i.defaultPrompt,...i.rows&&{rows:i.rows}};O(n=>[...n,{id:Date.now()+2,type:"bot",content:e,isNew:!0},{id:Date.now()+3,type:t,inputConfig:o,isComplete:!1,isNew:!0}])}else O(e=>[...e,{id:Date.now()+2,type:"bot",content:"Thank you! Here is a summary of your gig:\n".concat(JSON.stringify(n,null,2)),isNew:!0}])}catch(e){console.error("Error in sanitized confirmation:",e),q("Failed to process confirmation. Please try again.")}},[m,X,u]),eo=e=>{U||(W(e),J(t=>new Set([...t,"".concat(e,"-reformulate")])))};(0,o.useEffect)(()=>{let e=sessionStorage.getItem("referralCode");e&&A(e)},[]);let er=async(e,t)=>{let n={...m,discountCode:t||void 0};b(n),O(t=>t.map(t=>t.id===e?{...t,isComplete:!0}:t)),O(e=>[...e,{id:Date.now(),type:"bot",content:"Thank you! Here is a summary of your gig:\n".concat(JSON.stringify(n,null,2)),isNew:!0}])},ea=(e,t)=>{if("gigDate"===e&&t){let n=t;"string"==typeof t&&t.includes("T")&&(n=t.split("T")[0]),t instanceof Date&&(n=t.toISOString().split("T")[0]),b(t=>({...t,[e]:n}))}else if("gigTime"===e&&t){let n=Z(t);b(i=>({...i,[e]:n||t}))}else b(n=>({...n,[e]:t}))},es=async()=>{if(t){I(!0);try{var n;let i;if(m.gigLocation)if("object"==typeof m.gigLocation&&null!==m.gigLocation){let e=m.gigLocation;if(e.lat&&e.lng)i="Coordinates: ".concat(e.lat.toFixed(6),", ").concat(e.lng.toFixed(6));else if(e.formatted_address)i=e.formatted_address;else if(e.address)i=e.address;else{for(let t of Object.keys(e)){let n=e[t];if("string"==typeof n&&n.trim()&&"null"!==n&&"undefined"!==n){i=n;break}}i||(i="Location coordinates provided")}}else i=String(m.gigLocation);let o={userId:t.uid,gigDescription:String(m.gigDescription||"").trim(),additionalInstructions:m.additionalInstructions?String(m.additionalInstructions):void 0,hourlyRate:null!=(n=m.hourlyRate)?n:0,gigLocation:m.gigLocation,discountCode:m.discountCode,gigDate:String(m.gigDate||"").slice(0,10),gigTime:m.gigTime?String(m.gigTime):void 0},r=await x(o);if(200===r.status&&r.gigId){let n={id:Date.now()+1,type:"bot",content:"Thanks! Your gig has been created."};O(e=>[...e,n]),setTimeout(()=>{e.push("/user/".concat(t.uid,"/buyer"))},700)}else{let e=r.error||"Failed to create gig. Please try again.",t={id:Date.now()+2,type:"bot",content:e};O(e=>[...e,t])}}catch(t){let e={id:Date.now()+3,type:"bot",content:(null==t?void 0:t.message)||"Unexpected error creating gig."};O(t=>[...t,e])}finally{I(!1)}}};return((0,o.useEffect)(()=>{G&&(H(!0),b(e=>({...e,[G]:void 0})),O(e=>[...e.map(e=>"sanitized"===e.type&&e.fieldName===G?{...e,isComplete:!0}:e),{id:Date.now()+1,type:"typing",isNew:!0}]),setTimeout(()=>{O(e=>{let t=e.filter(e=>"typing"!==e.type),n=j.find(e=>e.name===G);return n?[...t,{id:Date.now()+2,type:"bot",content:"Could you provide your reformulated message?",isNew:!0},{id:Date.now()+3,type:"location"===n.type?"location":"date"===n.type?"calendar":"input",inputConfig:{type:n.type,name:n.name,placeholder:n.placeholder||n.defaultPrompt,rows:n.rows},isComplete:!1,isNew:!0}]:(console.error("Field config not found for:",G),t)})},700))},[G]),(0,o.useEffect)(()=>{p.current&&setTimeout(()=>{var e;null==(e=p.current)||e.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"})},100)},[E,Y]),(0,o.useEffect)(()=>{if(0===E.length){let e=j[0];O([{id:1,type:"bot",content:e.defaultPrompt},{id:2,type:"input",inputConfig:{type:e.type,name:e.name,placeholder:e.placeholder,...e.rows&&{rows:e.rows}},isComplete:!1}])}},[]),t)?(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(s.A,{ref:n,onScroll:()=>{},onHomeClick:()=>e.push("/user/".concat((null==t?void 0:t.uid)||"this_user","/buyer")),className:y().container,role:"BUYER",showChatInput:!0,onSendMessage:async e=>{console.log("ChatInput received:",e);let t=E.find(e=>("input"===e.type||"calendar"===e.type||"location"===e.type)&&!e.isComplete);if(t&&t.inputConfig){let n=t.inputConfig.name,i={id:Date.now(),type:"user",content:e,isNew:!0};O(e=>[...e,i]),ea(n,e),await ee(t.id,n,e)}},children:[E.map((e,t)=>{var n,o,r,s,p,u,f;let y="step-".concat(e.id,"-").concat(t);if("user"===e.type)return(0,i.jsx)(l.A,{text:e.content,senderType:"user",role:"BUYER",showAvatar:!1},y);if("sanitized"===e.type&&e.fieldName){let t=e.sanitizedValue;e.originalValue;let n="string"==typeof t?t:"object"==typeof t?JSON.stringify(t):String(t||""),o=V.has("".concat(e.fieldName,"-confirm")),r=V.has("".concat(e.fieldName,"-reformulate")),a=G===e.fieldName,s=e.isComplete||o||r;return(0,i.jsx)(l.A,{text:(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{marginBottom:8,color:"var(--secondary-color)",fontWeight:600,fontSize:"14px"},children:"This is what you wanted?"}),"string"==typeof n?(0,i.jsx)("div",{style:{marginBottom:16,fontStyle:"italic",color:"#e5e5e5",fontSize:"15px",lineHeight:"1.4"},children:n}):n,(0,i.jsxs)("div",{style:{display:"flex",gap:12},children:[(0,i.jsx)("button",{style:{background:s?"#555":"var(--secondary-color)",color:s?"#fff":"#000",border:"none",borderRadius:8,padding:"8px 16px",fontWeight:600,fontSize:"14px",cursor:s?"not-allowed":"pointer",transition:"background-color 0.2s",opacity:s?.7:1},onClick:s?void 0:()=>ei(e.fieldName,e.sanitizedValue),disabled:s,onMouseOver:e=>{s||(e.currentTarget.style.background="var(--secondary-darker-color)",e.currentTarget.style.color="#000")},onMouseOut:e=>{e.currentTarget.style.background=s?"#555":"var(--secondary-color)",e.currentTarget.style.color=s?"#fff":"#000"},children:o?"Confirmed":"Confirm"}),(0,i.jsx)("button",{style:{background:s?"#555":"transparent",color:s?"#999":"var(--secondary-color)",border:"1px solid var(--secondary-color)",borderRadius:8,padding:"8px 16px",fontWeight:600,fontSize:"14px",cursor:s?"not-allowed":"pointer",transition:"all 0.2s",opacity:s?.7:1},onClick:s?void 0:()=>eo(e.fieldName),disabled:s,onMouseOver:e=>{s||(e.currentTarget.style.background="var(--secondary-color)",e.currentTarget.style.color="#fff")},onMouseOut:e=>{e.currentTarget.style.background="transparent",e.currentTarget.style.color="var(--secondary-color)"},children:r?"videoIntro"===e.fieldName?"Re-shot":"Edited":a?"videoIntro"===e.fieldName?"Re-shooting...":"Editing...":"videoIntro"===e.fieldName?"Re-shoot":"Edit message"})]})]}),senderType:"bot",role:"BUYER",showAvatar:!0},y)}if("bot"===e.type&&"string"==typeof e.content&&e.content.startsWith("Thank you! Here is a summary of your gig:")){let t=e.content.match(/Thank you! Here is a summary of your gig:\n([\s\S]*)/),n=null;if(t)try{n=JSON.parse(t[1])}catch(e){n=null}return n?(0,i.jsx)(l.A,{text:(0,i.jsxs)("div",{style:{background:"#222",color:"#fff",borderRadius:8,padding:16,margin:"16px 0",boxShadow:"0 2px 8px #0002"},children:[(0,i.jsx)("h3",{style:{marginTop:0},children:"Gig Summary"}),(0,i.jsx)("ul",{style:{listStyle:"none",padding:0},children:Object.entries(n).map(e=>{let[t,n]=e;return"gigLocation"===t&&"string"==typeof n&&n.length>40?(0,i.jsxs)("li",{style:{marginBottom:8},children:[(0,i.jsxs)("strong",{style:{textTransform:"capitalize"},children:[t.replace(/([A-Z])/g," $1"),": "]}),(0,i.jsx)("span",{style:{cursor:"pointer",wordBreak:"break-all",display:"inline-block",maxWidth:M[t]?"100%":220,whiteSpace:M[t]?"normal":"nowrap",overflow:"hidden",textOverflow:M[t]?"clip":"ellipsis",verticalAlign:"bottom"},title:M[t]?"Click to collapse":"Click to expand",onClick:()=>z(e=>({...e,[t]:!e[t]})),children:M[t]?n:n.slice(0,37)+"..."})]},t):(0,i.jsxs)("li",{style:{marginBottom:8},children:[(0,i.jsxs)("strong",{style:{textTransform:"capitalize"},children:[t.replace(/([A-Z])/g," $1"),": "]}),(0,i.jsx)("span",{children:"hourlyRate"===t&&"number"==typeof n?"\xa3".concat(n.toFixed(2)):n&&"object"==typeof n&&"lat"in n&&"lng"in n?n.formatted_address||"Coordinates: ".concat(n.lat.toFixed(6),", ").concat(n.lng.toFixed(6)):"gigDate"===t?function(e){if(!e)return"";try{if("string"==typeof e&&e.includes("T")||"string"==typeof e&&e.match(/^\d{4}-\d{2}-\d{2}$/))return new Date(e).toLocaleDateString("en-GB",{weekday:"long",year:"numeric",month:"long",day:"numeric"});if(e instanceof Date)return e.toLocaleDateString("en-GB",{weekday:"long",year:"numeric",month:"long",day:"numeric"});return String(e)}catch(t){return String(e)}}(n):"gigTime"===t?function(e){if(!e)return"";try{if("string"==typeof e&&e.includes(" to ")){let[t,n]=e.split(" to "),i=K(t),o=K(n);return"".concat(i," to ").concat(o)}return K(e)}catch(t){return String(e)}}(n):"object"==typeof n?JSON.stringify(n):String(n)})]},t)})}),(0,i.jsxs)("button",{style:{marginTop:16,background:"var(--secondary-color)",color:"#fff",border:"none",borderRadius:8,padding:"8px 16px",fontWeight:600,transition:"all 0.3s ease",transform:"scale(1)",animation:"pulse 2s infinite"},onClick:()=>{T||es()},disabled:T,onMouseOver:e=>{e.currentTarget.style.transform="scale(1.05)",e.currentTarget.style.background="var(--secondary-darker-color)"},onMouseOut:e=>{e.currentTarget.style.transform="scale(1)",e.currentTarget.style.background="var(--secondary-color)"},children:[(0,i.jsx)("style",{children:"\n                          @keyframes pulse {\n                            0% {\n                              box-shadow: 0 0 0 0 rgba(34, 211, 238, 0.7);\n                            }\n                            70% {\n                              box-shadow: 0 0 0 10px rgba(34, 211, 238, 0);\n                            }\n                            100% {\n                              box-shadow: 0 0 0 0 rgba(34, 211, 238, 0);\n                            }\n                          }\n                        "}),T?"Creating...":"Confirm & Go to Dashboard"]})]}),senderType:"bot",role:"BUYER"},y):(0,i.jsx)(l.A,{text:e.content,senderType:"bot",role:"BUYER"},y)}return"bot"===e.type?(0,i.jsx)(l.A,{text:e.content,senderType:"bot",role:"BUYER"},y):"user"===e.type?(0,i.jsx)(l.A,{text:"object"==typeof e.content?JSON.stringify(e.content):String(e.content),senderType:"user",showAvatar:!1,role:"BUYER"},y):"typing"===e.type?(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{display:"flex",alignItems:"flex-start",gap:"0.5rem",marginBottom:"0.5rem"},children:(0,i.jsx)("div",{style:{flexShrink:0,marginTop:"0.25rem"},children:(0,i.jsx)("div",{style:{width:"32px",height:"32px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, var(--secondary-color), var(--secondary-darker-color))",boxShadow:"0 2px 8px rgba(34, 211, 238, 0.3)"},children:(0,i.jsx)("div",{style:{width:"28px",height:"28px",borderRadius:"50%",background:"#000000",display:"flex",alignItems:"center",justifyContent:"center",border:"1px solid rgba(255, 255, 255, 0.2)"},children:(0,i.jsx)(a.default,{src:"/images/ableai.png",alt:"Able AI",width:24,height:24,style:{borderRadius:"50%",objectFit:"cover"}})})})})},"".concat(y,"-avatar")),(0,i.jsx)("div",{children:(0,i.jsx)(k,{})},"".concat(y,"-typing"))]},y):"input"===e.type?null:"discountCode"!==e.type||e.isComplete?"calendar"===e.type?(0,i.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:"0.5rem",marginBottom:"0.5rem"},children:[(0,i.jsx)("div",{style:{flexShrink:0,marginTop:"0.25rem"},children:(0,i.jsx)("div",{style:{width:"32px",height:"32px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, var(--secondary-color), var(--secondary-darker-color))",boxShadow:"0 2px 8px rgba(126, 238, 249, 0.3)"},children:(0,i.jsx)("div",{style:{width:"28px",height:"28px",borderRadius:"50%",background:"#000000",display:"flex",alignItems:"center",justifyContent:"center",border:"1px solid rgba(255, 255, 255, 0.2)"},children:(0,i.jsx)(a.default,{src:"/images/ableai.png",alt:"Able AI",width:24,height:24,style:{borderRadius:"50%",objectFit:"cover"}})})})},"".concat(y,"-avatar")),(0,i.jsxs)("div",{style:{flex:1},children:[(0,i.jsx)(d.A,{name:null==(n=e.inputConfig)?void 0:n.name,value:m[(null==(o=e.inputConfig)?void 0:o.name)||""]?new Date(m[(null==(r=e.inputConfig)?void 0:r.name)||""]):null,onChange:t=>{var n;(null==(n=e.inputConfig)?void 0:n.name)&&ea(e.inputConfig.name,t)},placeholderText:(null==(s=e.inputConfig)?void 0:s.placeholder)||"Select a date",role:"BUYER"}),m[(null==(p=e.inputConfig)?void 0:p.name)||""]&&!_.has(e.id)&&(0,i.jsx)("div",{style:{marginTop:"12px",display:"flex",justifyContent:"flex-end"},children:(0,i.jsx)("button",{style:{background:D?"#555":"var(--secondary-color)",border:"none",borderRadius:"8px",padding:"8px 16px",fontWeight:600,fontSize:"14px",cursor:D?"not-allowed":"pointer",transition:"background-color 0.2s",opacity:D?.7:1},onClick:()=>{var t;(null==(t=e.inputConfig)?void 0:t.name)&&!D&&en(e.id,e.inputConfig.name)},onMouseOver:e=>{D||(e.currentTarget.style.background="var(--secondary-darker-color)")},onMouseOut:e=>{D||(e.currentTarget.style.background="var(--secondary-color)")},disabled:D,children:D?"Confirming...":"Confirm Date"})}),_.has(e.id)&&(0,i.jsx)("div",{style:{marginTop:"12px",display:"flex",justifyContent:"flex-end"},children:(0,i.jsxs)("div",{style:{background:"var(--secondary-color)",border:"none",borderRadius:"8px",padding:"8px 16px",fontWeight:600,fontSize:"14px",display:"flex",alignItems:"center",gap:"8px"},children:[(0,i.jsx)("span",{children:"✓"}),"Date Confirmed"]})})]},"".concat(y,"-calendar"))]},y):"location"===e.type?(0,i.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:"0.5rem",marginBottom:"0.5rem"},children:[(0,i.jsx)("div",{style:{flexShrink:0,marginTop:"0.25rem"},children:(0,i.jsx)("div",{style:{width:"32px",height:"32px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, var(--secondary-color), var(--secondary-darker-color))",boxShadow:"0 2px 8px rgba(126, 238, 249, 0.3)"},children:(0,i.jsx)("div",{style:{width:"28px",height:"28px",borderRadius:"50%",background:"#000000",display:"flex",alignItems:"center",justifyContent:"center",border:"1px solid rgba(255, 255, 255, 0.2)"},children:(0,i.jsx)(a.default,{src:"/images/ableai.png",alt:"Able AI",width:24,height:24,style:{borderRadius:"50%",objectFit:"cover"}})})})},"".concat(y,"-avatar")),(0,i.jsxs)("div",{style:{flex:1},children:[(0,i.jsx)(c.A,{value:m[(null==(u=e.inputConfig)?void 0:u.name)||""],onChange:t=>{var n;(null==(n=e.inputConfig)?void 0:n.name)&&ea(e.inputConfig.name,t)},role:"BUYER"}),m[(null==(f=e.inputConfig)?void 0:f.name)||""]&&!_.has(e.id)&&(0,i.jsx)("div",{style:{marginTop:"12px",display:"flex",justifyContent:"flex-end"},children:(0,i.jsx)("button",{style:{background:D?"#555":"var(--secondary-color)",border:"none",borderRadius:"8px",padding:"8px 16px",fontWeight:600,fontSize:"14px",cursor:D?"not-allowed":"pointer",transition:"background-color 0.2s",opacity:D?.7:1},onClick:()=>{var t;(null==(t=e.inputConfig)?void 0:t.name)&&!D&&en(e.id,e.inputConfig.name)},onMouseOver:e=>{D||(e.currentTarget.style.background="var(--secondary-darker-color)")},onMouseOut:e=>{D||(e.currentTarget.style.background="var(--secondary-color)")},disabled:D,children:D?"Confirming...":"Confirm Location"})}),_.has(e.id)&&(0,i.jsx)("div",{style:{marginTop:"12px",display:"flex",justifyContent:"flex-end"},children:(0,i.jsxs)("div",{style:{background:"var(--secondary-color)",border:"none",borderRadius:"8px",padding:"8px 16px",fontWeight:600,fontSize:"14px",display:"flex",alignItems:"center",gap:"8px"},children:[(0,i.jsx)("span",{children:"✓"}),"Location Confirmed"]})})]},"".concat(y,"-location"))]},y):null:(0,i.jsx)(g,{sessionCode:null!=N?N:null,onConfirm:t=>{er(e.id,t)},role:"BUYER"},y)}),(0,i.jsx)("div",{ref:p}),T&&(0,i.jsx)(l.A,{text:"Processing...",senderType:"bot",role:"BUYER"},"submitting-msg")]})}):(0,i.jsx)(f.A,{})}k.displayName="TypingIndicator"},81403:e=>{e.exports={promptText:"DiscountCodeBubble_promptText__swYp5",promptTextLargeMargin:"DiscountCodeBubble_promptTextLargeMargin__Vq6UJ",confirmedMessage:"DiscountCodeBubble_confirmedMessage__hiVbX",buttonContainer:"DiscountCodeBubble_buttonContainer__8PISY",codeInput:"DiscountCodeBubble_codeInput__BFu64",bubbleButton:"DiscountCodeBubble_bubbleButton__tWj4n",primary:"DiscountCodeBubble_primary__af3b9",secondary:"DiscountCodeBubble_secondary__bg7WY"}}},e=>{var t=t=>e(e.s=t);e.O(0,[7918,2006,3151,2481,756,2992,5965,5579,6084,2545,94,3063,6874,6681,5020,1163,3816,8441,1684,7358],()=>t(67689)),_N_E=e.O()}]);