(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3899],{34477:(e,r,t)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),!function(e,r){for(var t in r)Object.defineProperty(e,t,{enumerable:!0,get:r[t]})}(r,{callServer:function(){return a.callServer},createServerReference:function(){return o},findSourceMapURL:function(){return n.findSourceMapURL}});let a=t(53806),n=t(31818),o=t(34979).createServerReference},35461:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>g});var a=t(95155),n=t(12115),o=t(35695),i=t(51154),s=t(25731),l=t(1444),u=t(86325),c=t(34477);let d=(0,c.createServerReference)("40cc0686f8991cfcb82ef6d697a39002e1df90ae4a",c.callServer,void 0,c.findSourceMapURL,"processGigPayment");async function f(e){return await new Promise(e=>setTimeout(e,500)),{id:e,role:"Bartender",workerName:"Benji Asamoah",workerAvatarUrl:"/images/benji.jpeg",workerId:"benji-asamoah-id",date:new Date(Date.now()-1728e5).toISOString(),hourlyRate:25,hoursWorked:8,totalPayment:200,duration:"4 hours",details:"Completed gig on Monday, 9:00 am. Location: Central Train station",earnings:80}}function g(){let e=(0,o.useRouter)(),r=(0,o.useParams)(),t=r.userId,c=r.gigId,g=(0,u.K)(),{user:m,loading:v}=(0,s.A)(),y=null==m?void 0:m.uid,[h,S]=(0,n.useState)(null),[b,k]=(0,n.useState)(!0),[w,p]=(0,n.useState)(!1),[R,j]=(0,n.useState)(null),[_,E]=(0,n.useState)(null);(0,n.useEffect)(()=>{!v&&((null==m?void 0:m.claims.role)==="QA"&&c||m&&y===t&&c)&&(k(!0),f(c).then(e=>{e?S(e):j("Gig not found, not ready for feedback, or feedback already submitted.")}).catch(e=>{j("Could not load gig information for feedback."+JSON.stringify(e))}).finally(()=>k(!1)))},[m,v,y,t,c]);let N=async r=>(j(null),E(null),r.wouldHireAgain)?h&&(null==m?void 0:m.uid)?void("BUYER"===g&&await P(),p(!0),setTimeout(()=>{E("Feedback for ".concat(h.workerName," submitted successfully!")),p(!1),e.push("/user/".concat((null==m?void 0:m.uid)||"this_user","/buyer"))},1500)):void j("Gig information or user ID is missing."):void j("Please select if you would hire this worker again."),P=async()=>{m&&h&&(await d({gigId:c}),E("Work paid successfully!"))};return v||b?(0,a.jsxs)("div",{className:"flex items-center justify-center h-40",children:[(0,a.jsx)(i.A,{className:"animate-spin",size:32})," Loading..."]}):(0,a.jsx)(l.A,{gigData:h,user:m,role:"BUYER",mode:"buyer",onSubmit:N,loading:w,error:R,successMessage:_,handleBack:()=>e.back()})}},48075:(e,r,t)=>{Promise.resolve().then(t.bind(t,35461))},86325:(e,r,t)=>{"use strict";async function a(e){try{return localStorage.setItem("lastRoleUsed",e),null}catch(e){console.log("Error updating last role used:",e)}}function n(){try{return window.localStorage.getItem("lastRoleUsed")}catch(e){return console.log("Error retrieving last role used:",e),null}}t.d(r,{C:()=>a,K:()=>n})}},e=>{var r=r=>e(e.s=r);e.O(0,[5146,3151,2006,2992,5965,94,3063,6874,3529,8441,1684,7358],()=>r(48075)),_N_E=e.O()}]);