(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4370],{6557:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>c});var n=a(95155),s=a(12115),i=a(35695),o=a(25731),r=a(76353),l=a.n(r);function c(){let e=(0,i.useParams)(),t=(0,i.useRouter)(),{user:a}=(0,o.A)(),[r,c]=(0,s.useState)(null),[u,d]=(0,s.useState)(!0),[m,g]=(0,s.useState)(""),[h,p]=(0,s.useState)(null),[_,x]=(0,s.useState)(""),[C,j]=(0,s.useState)(""),[f,b]=(0,s.useState)(!1),v=e.gigId,S=e.userId;(0,s.useEffect)(()=>{(async()=>{if(a)try{let e=await fetch("/api/gigs/".concat(v));e.ok?await e.json():console.error("Failed to fetch gig")}catch(e){console.error("Error fetching gig:",e)}finally{d(!1)}})()},[v,a]);let w=async()=>{if(r&&a){b(!0);try{let e={gigId:r.id,feedback:m,wouldWorkAgain:h,awardBuyer:_,expenses:C.trim()||null,completedAt:new Date().toISOString()};(await fetch("/api/gigs/complete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok?t.push("/user/".concat(S,"/worker/gigs/").concat(v)):console.error("Failed to complete gig")}catch(e){console.error("Error completing gig:",e)}finally{b(!1)}}};if(u)return(0,n.jsx)("div",{className:l().container,children:(0,n.jsx)("div",{className:l().loading,children:"Loading..."})});if(!r)return(0,n.jsx)("div",{className:l().container,children:(0,n.jsx)("div",{className:l().error,children:"Gig not found"})});let P=(e=>{let t=e.match(/(\d{1,2}):(\d{2})\s*(am|pm)?\s*-\s*(\d{1,2}):(\d{2})\s*(am|pm)?/i);if(t){var a,n,s,i;let e=parseInt(t[1]),o=parseInt(t[4]);return(null==(a=t[3])?void 0:a.toLowerCase())==="pm"&&12!==e&&(e+=12),(null==(n=t[6])?void 0:n.toLowerCase())==="pm"&&12!==o&&(o+=12),(null==(s=t[3])?void 0:s.toLowerCase())==="am"&&12===e&&(e=0),(null==(i=t[6])?void 0:i.toLowerCase())==="am"&&12===o&&(o=0),Math.max(o-e,1)}return 4})(r.gigTime),k=(r.hourlyRate*P).toFixed(2);return(0,n.jsxs)("div",{className:l().container,children:[(0,n.jsx)("div",{className:l().header,children:(0,n.jsx)("h1",{children:"Confirm Hours Worked & Feedback"})}),(0,n.jsxs)("div",{className:l().gigSummary,children:[(0,n.jsx)("h2",{children:r.gigDescription}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Duration:"})," ",P," hours"]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Completed gig on:"})," ",new Date(r.gigDate).toLocaleDateString("en-GB",{weekday:"long",day:"numeric",month:"long",year:"numeric"})]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Location:"})," ",r.location]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Earnings:"})," \xa3",k]})]}),(0,n.jsxs)("div",{className:l().feedbackSection,children:[(0,n.jsx)("h3",{children:"Share your experience..."}),(0,n.jsx)("p",{children:"Provide feedback to earn awards"}),(0,n.jsx)("textarea",{className:l().feedbackInput,placeholder:"Tell us about your experience working this gig...",value:m,onChange:e=>g(e.target.value),rows:4}),(0,n.jsxs)("div",{className:l().workAgainSection,children:[(0,n.jsx)("h4",{children:"Would you work with this buyer again?"}),(0,n.jsxs)("div",{className:l().thumbsContainer,children:[(0,n.jsx)("button",{className:"".concat(l().thumbsButton," ").concat(!0===h?l().active:""),onClick:()=>p(!0),children:"\uD83D\uDC4D"}),(0,n.jsx)("button",{className:"".concat(l().thumbsButton," ").concat(!1===h?l().active:""),onClick:()=>p(!1),children:"\uD83D\uDC4E"})]})]}),(0,n.jsxs)("div",{className:l().awardSection,children:[(0,n.jsx)("h4",{children:"Would you like to award the buyer?"}),(0,n.jsxs)("div",{className:l().awardButtons,children:[(0,n.jsx)("button",{className:"".concat(l().awardButton," ").concat("top_communicator"===_?l().active:""),onClick:()=>x("top_communicator"===_?"":"top_communicator"),children:"\uD83C\uDFC6 Top communicator"}),(0,n.jsx)("button",{className:"".concat(l().awardButton," ").concat("team_builder"===_?l().active:""),onClick:()=>x("team_builder"===_?"":"team_builder"),children:"\uD83D\uDC65 Team builder"})]})]})]}),(0,n.jsxs)("div",{className:l().expensesSection,children:[(0,n.jsx)("h3",{children:"Log any expenses you incurred here"}),(0,n.jsxs)("div",{className:l().expensesInput,children:[(0,n.jsx)("span",{className:l().paperclipIcon,children:"\uD83D\uDCCE"}),(0,n.jsx)("input",{type:"text",placeholder:"Note & upload images of costs incurred for your taxi",value:C,onChange:e=>j(e.target.value)})]})]}),(0,n.jsxs)("div",{className:l().actionButtons,children:[(0,n.jsx)("button",{className:l().amendButton,children:"Amend gig timing or add tips"}),(0,n.jsx)("button",{className:l().submitButton,onClick:w,disabled:f,children:f?"Submitting...":"Submit for payment"})]})]})}},25731:(e,t,a)=>{"use strict";a.d(t,{A:()=>u,O:()=>c});var n=a(95155),s=a(12115),i=a(16203),o=a(85004);let r=(0,s.createContext)({user:null,loading:!0});async function l(e){for(let a=0;a<10;a++){var t;let a=await (0,i.yx)(e,!0);if(null==(t=a.claims)?void 0:t.role)return a;await new Promise(e=>setTimeout(e,1e3))}return null}let c=e=>{let{children:t}=e,[a,c]=(0,s.useState)(null),[u,d]=(0,s.useState)(!0),{authClient:m,loading:g}=(0,o.D)();return(0,s.useEffect)(()=>{let e=()=>{};return!g&&m&&(e=(0,i.hg)(m,async e=>{if(e){let t=await l(e);t?c(Object.assign(e,{token:t.token,claims:t.claims})):c(null)}else c(null);d(!1)})),()=>e()},[g]),(0,n.jsx)(r.Provider,{value:{user:a,loading:u},children:t})},u=()=>(0,s.useContext)(r)},35695:(e,t,a)=>{"use strict";var n=a(18999);a.o(n,"useParams")&&a.d(t,{useParams:function(){return n.useParams}}),a.o(n,"usePathname")&&a.d(t,{usePathname:function(){return n.usePathname}}),a.o(n,"useRouter")&&a.d(t,{useRouter:function(){return n.useRouter}}),a.o(n,"useSearchParams")&&a.d(t,{useSearchParams:function(){return n.useSearchParams}})},76353:e=>{e.exports={container:"CompleteGigPage_container__SjEms",header:"CompleteGigPage_header__GAMNM",gigSummary:"CompleteGigPage_gigSummary__h4ia9",feedbackSection:"CompleteGigPage_feedbackSection__oHRC0",feedbackInput:"CompleteGigPage_feedbackInput___4qCM",workAgainSection:"CompleteGigPage_workAgainSection__syk8a",thumbsContainer:"CompleteGigPage_thumbsContainer__kWuFp",thumbsButton:"CompleteGigPage_thumbsButton__psiqj",active:"CompleteGigPage_active__BfISp",awardSection:"CompleteGigPage_awardSection__XK1Fq",awardButtons:"CompleteGigPage_awardButtons__GnW8q",awardButton:"CompleteGigPage_awardButton__PQejg",expensesSection:"CompleteGigPage_expensesSection__6jxv4",expensesInput:"CompleteGigPage_expensesInput__6yuID",paperclipIcon:"CompleteGigPage_paperclipIcon__eq_7t",actionButtons:"CompleteGigPage_actionButtons__bUGvO",amendButton:"CompleteGigPage_amendButton__Ny6EZ",submitButton:"CompleteGigPage_submitButton__o_EBF",loading:"CompleteGigPage_loading__YcN3v",error:"CompleteGigPage_error__rtIZa"}},76552:(e,t,a)=>{Promise.resolve().then(a.bind(a,6557))},85004:(e,t,a)=>{"use strict";a.d(t,{D:()=>g,R:()=>m});var n=a(95155),s=a(12115),i=a(23915),o=a(16203),r=a(35317),l=a(90858),c=a(74826),u=a(20996);let d=(0,s.createContext)(null),m=e=>{let{children:t}=e,[a,m]=s.useState(null),[g,h]=s.useState(null),[p,_]=s.useState(null),[x,C]=s.useState(null),[j,f]=s.useState(null),[b,v]=s.useState(!0);return(0,s.useEffect)(()=>{!async function(){let e,t=await fetch("/firebase-config.json"),a=await t.json();0===(0,i.Dk)().length?(console.log("[Firebase] Initializing new instance..."),e=(0,i.Wp)(a)):(console.log("[Firebase] Reusing existing instance."),e=(0,i.Sx)()),m((0,o.xI)(e)),_((0,r.aU)(e)),C((0,l.c7)(e)),f((0,c.lS)(e,{backend:new c.C8})),h((0,u.dG)(e)),v(!1)}()},[]),(0,n.jsx)(d.Provider,{value:{authClient:a,db:p,storage:x,ai:j,messaging:g,loading:b},children:t})},g=()=>{let e=(0,s.useContext)(d);if(!e)throw Error("useFirebase must be used within FirebaseProvider");return e}}},e=>{var t=t=>e(e.s=t);e.O(0,[6806,2992,5965,94,8441,1684,7358],()=>t(76552)),_N_E=e.O()}]);