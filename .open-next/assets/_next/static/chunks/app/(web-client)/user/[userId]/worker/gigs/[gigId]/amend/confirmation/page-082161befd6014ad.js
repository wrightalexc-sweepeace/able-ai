(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9208],{25731:(e,n,a)=>{"use strict";a.d(n,{A:()=>d,O:()=>l});var t=a(95155),i=a(12115),s=a(16203),r=a(85004);let o=(0,i.createContext)({user:null,loading:!0});async function c(e){for(let a=0;a<10;a++){var n;let a=await (0,s.yx)(e,!0);if(null==(n=a.claims)?void 0:n.role)return a;await new Promise(e=>setTimeout(e,1e3))}return null}let l=e=>{let{children:n}=e,[a,l]=(0,i.useState)(null),[d,u]=(0,i.useState)(!0),{authClient:m,loading:h}=(0,r.D)();return(0,i.useEffect)(()=>{let e=()=>{};return!h&&m&&(e=(0,s.hg)(m,async e=>{if(e){let n=await c(e);n?l(Object.assign(e,{token:n.token,claims:n.claims})):l(null)}else l(null);u(!1)})),()=>e()},[h]),(0,t.jsx)(o.Provider,{value:{user:a,loading:d},children:n})},d=()=>(0,i.useContext)(o)},33654:e=>{e.exports={container:"AmendGigConfirmationPage_container__K0voX",header:"AmendGigConfirmationPage_header___62b9",infoIcon:"AmendGigConfirmationPage_infoIcon__2hJhO",confirmationMessage:"AmendGigConfirmationPage_confirmationMessage__Wk5cS",aiIcon:"AmendGigConfirmationPage_aiIcon__fXRQo",updatedDetailsSection:"AmendGigConfirmationPage_updatedDetailsSection__r7FHO",detailsGrid:"AmendGigConfirmationPage_detailsGrid__74eD5",detailRow:"AmendGigConfirmationPage_detailRow__v7wLx",label:"AmendGigConfirmationPage_label__s6ZCS",value:"AmendGigConfirmationPage_value__8S_hQ",changesSummary:"AmendGigConfirmationPage_changesSummary__kFISP",actionButtons:"AmendGigConfirmationPage_actionButtons__nabmy",confirmButton:"AmendGigConfirmationPage_confirmButton__o5dzU",declineButton:"AmendGigConfirmationPage_declineButton__b_Jy7",loading:"AmendGigConfirmationPage_loading__5WCZn",error:"AmendGigConfirmationPage_error__S7xQy"}},34220:(e,n,a)=>{Promise.resolve().then(a.bind(a,56127))},35695:(e,n,a)=>{"use strict";var t=a(18999);a.o(t,"useParams")&&a.d(n,{useParams:function(){return t.useParams}}),a.o(t,"usePathname")&&a.d(n,{usePathname:function(){return t.usePathname}}),a.o(t,"useRouter")&&a.d(n,{useRouter:function(){return t.useRouter}}),a.o(t,"useSearchParams")&&a.d(n,{useSearchParams:function(){return t.useSearchParams}})},56127:(e,n,a)=>{"use strict";a.r(n),a.d(n,{default:()=>l});var t=a(95155),i=a(12115),s=a(35695),r=a(25731),o=a(33654),c=a.n(o);function l(){let e=(0,s.useParams)(),n=(0,s.useRouter)(),{user:a}=(0,r.A)(),[o,l]=(0,i.useState)(null),[d,u]=(0,i.useState)(null),[m,h]=(0,i.useState)(!0),[g,f]=(0,i.useState)(!1),_=e.gigId,x=e.userId;(0,i.useEffect)(()=>{(async()=>{if(a)try{let e=await fetch("/api/gigs/".concat(_));e.ok&&await e.json();let n=await fetch("/api/gigs/".concat(_,"/amendment-request"));n.ok&&await n.json()}catch(e){console.error("Error fetching data:",e)}finally{h(!1)}})()},[_,a]);let j=e=>new Date(e).toLocaleDateString("en-GB",{weekday:"long",day:"numeric",month:"long",year:"numeric"}),p=async()=>{if(o&&d&&a){f(!0);try{(await fetch("/api/gigs/".concat(_,"/confirm-amendment"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amendmentId:d.id,confirmedBy:"worker",confirmedAt:new Date().toISOString()})})).ok?n.push("/user/".concat(x,"/worker/gigs/").concat(_)):console.error("Failed to confirm amendment")}catch(e){console.error("Error confirming amendment:",e)}finally{f(!1)}}},v=async()=>{if(o&&d&&a&&window.confirm("Are you sure you want to decline these changes?"))try{(await fetch("/api/gigs/".concat(_,"/decline-amendment"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amendmentId:d.id,declinedBy:"worker",declinedAt:new Date().toISOString()})})).ok?n.push("/user/".concat(x,"/worker/gigs/").concat(_)):console.error("Failed to decline amendment")}catch(e){console.error("Error declining amendment:",e)}};if(m)return(0,t.jsx)("div",{className:c().container,children:(0,t.jsx)("div",{className:c().loading,children:"Loading..."})});if(!o||!d)return(0,t.jsx)("div",{className:c().container,children:(0,t.jsx)("div",{className:c().error,children:"Amendment request not found"})});let y=(e=>{let n=e.match(/(\d{1,2}):(\d{2})\s*-\s*(\d{1,2}):(\d{2})/);if(n){let e=parseInt(n[1]);return Math.max(parseInt(n[3])-e,1)}return 4})(o.gigTime),P=(o.hourlyRate*y).toFixed(2);return(0,t.jsxs)("div",{className:c().container,children:[(0,t.jsxs)("div",{className:c().header,children:[(0,t.jsx)("h1",{children:"Confirm amended Gig Details"}),(0,t.jsx)("span",{className:c().infoIcon,children:"ℹ️"})]}),(0,t.jsxs)("div",{className:c().confirmationMessage,children:[(0,t.jsx)("div",{className:c().aiIcon,children:"\uD83E\uDD16"}),(0,t.jsx)("p",{children:"Sue has added one hour to the gig, the update details are below. Please accept to confirm these changes"})]}),(0,t.jsxs)("div",{className:c().updatedDetailsSection,children:[(0,t.jsx)("h3",{children:"Updated gig details:"}),(0,t.jsxs)("div",{className:c().detailsGrid,children:[(0,t.jsxs)("div",{className:c().detailRow,children:[(0,t.jsx)("span",{className:c().label,children:"Location:"}),(0,t.jsx)("span",{className:c().value,children:o.location})]}),(0,t.jsxs)("div",{className:c().detailRow,children:[(0,t.jsx)("span",{className:c().label,children:"Date:"}),(0,t.jsx)("span",{className:c().value,children:j(o.gigDate)})]}),(0,t.jsxs)("div",{className:c().detailRow,children:[(0,t.jsx)("span",{className:c().label,children:"Time:"}),(0,t.jsx)("span",{className:c().value,children:(e=>{let n=e.match(/(\d{1,2}):(\d{2})\s*-\s*(\d{1,2}):(\d{2})/);if(n){let e=parseInt(n[1]),a=n[2],t=parseInt(n[3]),i=n[4];return"".concat(e>12?e-12:0===e?12:e,":").concat(a," ").concat(e>=12?"PM":"AM"," - ").concat(t>12?t-12:0===t?12:t,":").concat(i," ").concat(t>=12?"PM":"AM")}return e})(o.gigTime)})]}),(0,t.jsxs)("div",{className:c().detailRow,children:[(0,t.jsx)("span",{className:c().label,children:"Pay per hour:"}),(0,t.jsxs)("span",{className:c().value,children:["\xa3",o.hourlyRate]})]}),(0,t.jsxs)("div",{className:c().detailRow,children:[(0,t.jsx)("span",{className:c().label,children:"Total Pay:"}),(0,t.jsxs)("span",{className:c().value,children:["\xa3",P]})]})]}),(0,t.jsxs)("div",{className:c().changesSummary,children:[(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Requested Changes:"})," ",d.changes]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Requested by:"})," ","buyer"===d.requestedBy?"Buyer":"Worker"]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Requested on:"})," ",j(d.requestedAt)]})]})]}),(0,t.jsxs)("div",{className:c().actionButtons,children:[(0,t.jsx)("button",{className:c().confirmButton,onClick:p,disabled:g,children:g?"Confirming...":"Confirm changes"}),(0,t.jsx)("button",{className:c().declineButton,onClick:v,disabled:g,children:"Decline changes"})]})]})}},85004:(e,n,a)=>{"use strict";a.d(n,{D:()=>h,R:()=>m});var t=a(95155),i=a(12115),s=a(23915),r=a(16203),o=a(35317),c=a(90858),l=a(74826),d=a(20996);let u=(0,i.createContext)(null),m=e=>{let{children:n}=e,[a,m]=i.useState(null),[h,g]=i.useState(null),[f,_]=i.useState(null),[x,j]=i.useState(null),[p,v]=i.useState(null),[y,P]=i.useState(!0);return(0,i.useEffect)(()=>{!async function(){let e,n=await fetch("/firebase-config.json"),a=await n.json();0===(0,s.Dk)().length?(console.log("[Firebase] Initializing new instance..."),e=(0,s.Wp)(a)):(console.log("[Firebase] Reusing existing instance."),e=(0,s.Sx)()),m((0,r.xI)(e)),_((0,o.aU)(e)),j((0,c.c7)(e)),v((0,l.lS)(e,{backend:new l.C8})),g((0,d.dG)(e)),P(!1)}()},[]),(0,t.jsx)(u.Provider,{value:{authClient:a,db:f,storage:x,ai:p,messaging:h,loading:y},children:n})},h=()=>{let e=(0,i.useContext)(u);if(!e)throw Error("useFirebase must be used within FirebaseProvider");return e}}},e=>{var n=n=>e(e.s=n);e.O(0,[5093,2992,5965,94,8441,1684,7358],()=>n(34220)),_N_E=e.O()}]);