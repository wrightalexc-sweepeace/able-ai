(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9908],{1243:(e,t,a)=>{"use strict";a.d(t,{A:()=>i});let i=(0,a(19946).A)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},6188:(e,t,a)=>{"use strict";a.d(t,{A:()=>_});var i=a(95155);a(12115);var n=a(35169),r=a(12908),o=a.n(r),s=a(6874),c=a.n(s),l=a(25731),u=a(53843),d=a(35695),f=a(66766),h=a(61508),m=a.n(h);let g=e=>{let{uid:t,handleClick:a,unreadCount:n,unreadNotifications:r}=e;return(0,i.jsxs)(c(),{href:"/user/".concat(t,"/notifications"),passHref:!0,onClick:a,children:[(0,i.jsx)("button",{className:m().notificationButton,"aria-label":"Notifications",children:(0,i.jsx)(f.default,{src:"/images/notifications.svg",alt:"Notifications",width:40,height:40})}),n>0||r>0?(0,i.jsx)("span",{className:m().notificationBadge,children:n>0?n:r}):null]})},_=e=>{let{user:t}=(0,l.A)(),a=(0,d.usePathname)(),{isHomePage:r,title:s,onBackClick:h,handleClick:m,unreadCount:_,unreadNotifications:p}=e,v=a.includes("/able-ai");return(0,i.jsxs)("header",{className:o().header,children:[r?(0,i.jsx)(f.default,{src:"/images/home.svg",alt:"Back",width:40,height:40}):(0,i.jsx)("button",{onClick:h,className:o().backButton,"aria-label":"Go back",children:(0,i.jsx)(n.A,{size:20})}),s&&(0,i.jsx)("h1",{className:o().title,children:s}),(0,i.jsx)(c(),{href:"/user/".concat(null==t?void 0:t.uid,"/able-ai"),className:o().chat,children:v?(0,i.jsx)(u.A,{width:40,height:40}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{children:"Chat with Able"}),(0,i.jsx)(u.A,{width:30,height:30})]})}),r&&(0,i.jsx)(g,{uid:null==t?void 0:t.uid,handleClick:m,unreadCount:_,unreadNotifications:p})]})}},12449:e=>{e.exports={container:"NotificationsPage_container__Yh52o",card:"NotificationsPage_card__0_zTq",pageWrapper:"NotificationsPage_pageWrapper__e_Nl6",header:"NotificationsPage_header__nFg2r",backButton:"NotificationsPage_backButton__6tuqd",pageTitle:"NotificationsPage_pageTitle__2D5zp",notificationList:"NotificationsPage_notificationList__uRITO",notificationItem:"NotificationsPage_notificationItem___MRVr",unread:"NotificationsPage_unread__rXnhN",notificationContent:"NotificationsPage_notificationContent__ysUX_",notificationIcon:"NotificationsPage_notificationIcon__dojAY",notificationMessage:"NotificationsPage_notificationMessage__ihMT5",notificationTimestamp:"NotificationsPage_notificationTimestamp__t6TuL",chevron:"NotificationsPage_chevron__fJsro",footer:"NotificationsPage_footer__VPblN",homeButton:"NotificationsPage_homeButton__Ch50C",emptyState:"NotificationsPage_emptyState__fIQTd",loadingContainer:"NotificationsPage_loadingContainer__QIvvb"}},12908:e=>{e.exports={header:"ScreenHeaderWithBack_header__mx1Ch",backButton:"ScreenHeaderWithBack_backButton__0EIlD",title:"ScreenHeaderWithBack_title__Un97C",chat:"ScreenHeaderWithBack_chat__WpLse"}},13052:(e,t,a)=>{"use strict";a.d(t,{A:()=>i});let i=(0,a(19946).A)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},19946:(e,t,a)=>{"use strict";a.d(t,{A:()=>d});var i=a(12115);let n=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),r=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,a)=>a?a.toUpperCase():t.toLowerCase()),o=e=>{let t=r(e);return t.charAt(0).toUpperCase()+t.slice(1)},s=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim()},c=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let u=(0,i.forwardRef)((e,t)=>{let{color:a="currentColor",size:n=24,strokeWidth:r=2,absoluteStrokeWidth:o,className:u="",children:d,iconNode:f,...h}=e;return(0,i.createElement)("svg",{ref:t,...l,width:n,height:n,stroke:a,strokeWidth:o?24*Number(r)/Number(n):r,className:s("lucide",u),...!d&&!c(h)&&{"aria-hidden":"true"},...h},[...f.map(e=>{let[t,a]=e;return(0,i.createElement)(t,a)}),...Array.isArray(d)?d:[d]])}),d=(e,t)=>{let a=(0,i.forwardRef)((a,r)=>{let{className:c,...l}=a;return(0,i.createElement)(u,{ref:r,iconNode:t,className:s("lucide-".concat(n(o(e))),"lucide-".concat(e),c),...l})});return a.displayName=o(e),a}},25731:(e,t,a)=>{"use strict";a.d(t,{A:()=>u,O:()=>l});var i=a(95155),n=a(12115),r=a(16203),o=a(85004);let s=(0,n.createContext)({user:null,loading:!0});async function c(e){for(let a=0;a<10;a++){var t;let a=await (0,r.yx)(e,!0);if(null==(t=a.claims)?void 0:t.role)return a;await new Promise(e=>setTimeout(e,1e3))}return null}let l=e=>{let{children:t}=e,[a,l]=(0,n.useState)(null),[u,d]=(0,n.useState)(!0),{authClient:f,loading:h}=(0,o.D)();return(0,n.useEffect)(()=>{let e=()=>{};return!h&&f&&(e=(0,r.hg)(f,async e=>{if(e){let t=await c(e);t?l(Object.assign(e,{token:t.token,claims:t.claims})):l(null)}else l(null);d(!1)})),()=>e()},[h]),(0,i.jsx)(s.Provider,{value:{user:a,loading:u},children:t})},u=()=>(0,n.useContext)(s)},30504:(e,t,a)=>{"use strict";a.d(t,{q:()=>n});var i=a(34477);let n=(0,i.createServerReference)("400cd1fa767ef5281508e93e3ca1d7a0d11ad8371f",i.callServer,void 0,i.findSourceMapURL,"getAllNotificationsAction")},34477:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var a in t)Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}(t,{callServer:function(){return i.callServer},createServerReference:function(){return r},findSourceMapURL:function(){return n.findSourceMapURL}});let i=a(53806),n=a(31818),r=a(34979).createServerReference},35169:(e,t,a)=>{"use strict";a.d(t,{A:()=>i});let i=(0,a(19946).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},35695:(e,t,a)=>{"use strict";var i=a(18999);a.o(i,"useParams")&&a.d(t,{useParams:function(){return i.useParams}}),a.o(i,"usePathname")&&a.d(t,{usePathname:function(){return i.usePathname}}),a.o(i,"useRouter")&&a.d(t,{useRouter:function(){return i.useRouter}}),a.o(i,"useSearchParams")&&a.d(t,{useSearchParams:function(){return i.useSearchParams}})},39672:e=>{e.exports={loadingContainer:"Loader_loadingContainer__p_FTp",loader:"Loader_loader__8pViD",l3:"Loader_l3__h_z0X"}},43768:(e,t,a)=>{Promise.resolve().then(a.bind(a,97642))},51078:(e,t,a)=>{"use strict";a.d(t,{A:()=>o});var i=a(95155),n=a(39672),r=a.n(n);let o=e=>{let{customClass:t,customStyle:a}=e;return(0,i.jsx)("div",{className:t||r().loadingContainer,style:a,children:(0,i.jsx)("div",{className:r().loader})})}},53843:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});var i=a(95155);a(12115);var n=a(66766),r=a(69456),o=a.n(r);let s=e=>{let{width:t=260,height:a=260}=e;return(0,i.jsx)(n.default,{src:"/images/ableai.png",alt:"App Logo",width:t,height:a,className:o().logo})}},61508:e=>{e.exports={notificationButton:"Notification_notificationButton__NL740",notificationBadge:"Notification_notificationBadge__ZxPNU"}},66766:(e,t,a)=>{"use strict";a.d(t,{default:()=>n.a});var i=a(71469),n=a.n(i)},69456:e=>{e.exports={logo:"Logo_logo__aLQuM"}},71469:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var a in t)Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}(t,{default:function(){return c},getImageProps:function(){return s}});let i=a(88229),n=a(38883),r=a(33063),o=i._(a(51193));function s(e){let{props:t}=(0,n.getImgProps)(e,{defaultLoader:o.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,a]of Object.entries(t))void 0===a&&delete t[e];return{props:t}}let c=r.Image},81284:(e,t,a)=>{"use strict";a.d(t,{A:()=>i});let i=(0,a(19946).A)("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]])},85004:(e,t,a)=>{"use strict";a.d(t,{D:()=>h,R:()=>f});var i=a(95155),n=a(12115),r=a(23915),o=a(16203),s=a(35317),c=a(90858),l=a(74826),u=a(20996);let d=(0,n.createContext)(null),f=e=>{let{children:t}=e,[a,f]=n.useState(null),[h,m]=n.useState(null),[g,_]=n.useState(null),[p,v]=n.useState(null),[N,x]=n.useState(null),[j,k]=n.useState(!0);return(0,n.useEffect)(()=>{!async function(){let e,t=await fetch("/firebase-config.json"),a=await t.json();0===(0,r.Dk)().length?(console.log("[Firebase] Initializing new instance..."),e=(0,r.Wp)(a)):(console.log("[Firebase] Reusing existing instance."),e=(0,r.Sx)()),f((0,o.xI)(e)),_((0,s.aU)(e)),v((0,c.c7)(e)),x((0,l.lS)(e,{backend:new l.C8})),m((0,u.dG)(e)),k(!1)}()},[]),(0,i.jsx)(d.Provider,{value:{authClient:a,db:g,storage:p,ai:N,messaging:h,loading:j},children:t})},h=()=>{let e=(0,n.useContext)(d);if(!e)throw Error("useFirebase must be used within FirebaseProvider");return e}},97642:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>k});var i=a(95155),n=a(12115),r=a(35695),o=a(6874),s=a.n(o),c=a(66766),l=a(81284),u=a(1243),d=a(13052),f=a(12449),h=a.n(f),m=a(51078),g=a(25731),_=a(30504),p=a(34477);let v=(0,p.createServerReference)("60e7f34a33097c37a8e1219f48e58834e6fa037656",p.callServer,void 0,p.findSourceMapURL,"updateNotificationStatusAction");var N=a(6188);let x=e=>{if(!e)return null;switch(e){case"offer":case"gigUpdate":case"badge":case"referral":return(0,i.jsx)(c.default,{src:"/images/notifications.svg",width:20,height:20,className:h().notificationIcon,alt:"notification icon"});case"payment":case"system":default:return(0,i.jsx)(l.A,{size:20,className:h().notificationIcon});case"actionRequired":return(0,i.jsx)(u.A,{size:20,className:h().notificationIcon})}},j=e=>{let t=new Date(e),a=Math.round((new Date().getTime()-t.getTime())/1e3);if(a<60)return"".concat(a,"s ago");let i=Math.round(a/60);if(i<60)return"".concat(i,"m ago");let n=Math.round(i/60);if(n<24)return"".concat(n,"h ago");let r=Math.round(n/24);return r<7?"".concat(r,"d ago"):t.toLocaleDateString()};function k(){let e=(0,r.useRouter)(),t=(0,r.useParams)().userId,{user:a}=(0,g.A)(),o=null==a?void 0:a.token,l=null==a?void 0:a.uid,[u,f]=(0,n.useState)([]),[p,k]=(0,n.useState)(!0),[w,b]=(0,n.useState)(null);async function y(e){let{notifications:t}=await (0,_.q)(e);return t.map(e=>{var t,a,i,n;return{id:e.id,type:null!=(t=e.type)?t:"system",message:null!=(a=e.title)?a:"No title",link:null!=(i=e.path)?i:void 0,isRead:"unread"!==e.status,timestamp:null!=(n=e.createTime)?n:new Date().toISOString()}}).sort((e,t)=>new Date(t.timestamp).getTime()-new Date(e.timestamp).getTime())}(0,n.useEffect)(()=>{a&&o&&(k(!0),y(o).then(e=>{f(e),b(null)}).catch(e=>{console.error("Failed to fetch notifications:",e),b("Could not load notifications. Please try again.")}).finally(()=>k(!1)))},[a,o]);let P=async t=>{t.link&&e.push(t.link),await v(t.id,"read")};return!a||l&&l!==t?(0,i.jsx)(m.A,{}):(0,i.jsx)("div",{className:h().container,children:(0,i.jsxs)("div",{className:h().card,children:[(0,i.jsx)(N.A,{title:"Notifications",onBackClick:()=>{(null==a?void 0:a.claims.role)==="BUYER"?e.push("/user/".concat(l,"/buyer")):(null==a?void 0:a.claims.role)==="GIG_WORKER"?e.push("/user/".concat(l,"/worker")):a?e.push("/select-role"):e.back()}}),(0,i.jsxs)("div",{className:h().pageWrapper,children:[p?(0,i.jsx)(m.A,{}):w?(0,i.jsx)("div",{className:h().emptyState,children:w}):0===u.length?(0,i.jsx)("div",{className:h().emptyState,children:"You have no new notifications."}):(0,i.jsx)("div",{className:h().notificationList,children:u.map(e=>(0,i.jsxs)("div",{className:"".concat(h().notificationItem," ").concat(e.isRead?"":h().unread),onClick:()=>P(e),role:"button",tabIndex:0,onKeyPress:t=>"Enter"===t.key&&P(e),children:[(0,i.jsxs)("div",{className:h().notificationContent,children:[(null==e?void 0:e.icon)||x(e.type),(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{className:h().notificationMessage,children:e.message}),(0,i.jsx)("div",{className:h().notificationTimestamp,children:j(e.timestamp)})]})]}),(0,i.jsx)(d.A,{size:20,className:h().chevron})]},e.id))}),(0,i.jsx)("footer",{className:h().footer,children:(0,i.jsx)(s(),{href:(null==a?void 0:a.claims.role)==="BUYER"?"/user/".concat(l,"/buyer"):(null==a?void 0:a.claims.role)==="GIG_WORKER"?"/user/".concat(l,"/worker"):"/select-role",passHref:!0,children:(0,i.jsx)("button",{className:h().homeButton,"aria-label":"Go to Home",children:(0,i.jsx)(c.default,{src:"/images/home.svg",width:24,height:24,className:h().homeIcon,alt:"Home icon"})})})})]})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[5474,3151,2006,2992,5965,94,3063,6874,8441,1684,7358],()=>t(43768)),_N_E=e.O()}]);