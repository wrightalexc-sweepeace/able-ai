(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8713],{5781:(e,t,a)=>{Promise.resolve().then(a.bind(a,5960))},5960:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>Q});var i=a(95155),l=a(12115),n=a(35695),r=a(8181),o=a(9698),s=a(77088),c=a(91749),d=a(25731),u=a(11652),y=a(34477);let v=(0,y.createServerReference)("4036dcb842d9aeecc172ee483ab65d207e7f190ce8",y.callServer,void 0,y.findSourceMapURL,"getWorkerAvailability");function f(e,t,a){let i=[];return Array.isArray(e)?e.forEach(e=>{let l=function(e,t,a){let i=[];console.log("generateEventsFromSlot called with:",{frequency:e.frequency,days:e.days,ends:e.ends,occurrences:e.occurrences,startDate:t.toDateString(),endDate:a.toDateString()});let l=e.startDate?new Date(e.startDate):t,n=new Date;n.setHours(0,0,0,0);let r=new Date(Math.max(l.getTime(),t.getTime(),n.getTime()));if("never"===e.frequency){if(e.endDate){let t=new Date(e.endDate);if(t>=r&&t<=a){let a=h(e,t);a&&i.push(a)}}return i}let o=0,s=new Date(r),c=null;if("biweekly"===e.frequency){let t=new Date(r);for(;t<=a;){let a=b(m(t));if(e.days.includes(a)){c=new Date(t);break}t=new Date(t.getTime()+864e5)}}for(;s<=a;){let t=b(m(s));if(e.days.includes(t)){let a=!1;if("weekly"===e.frequency)a=!0;else if("biweekly"===e.frequency)if(console.log("Processing biweekly frequency for date: ".concat(s.toDateString())),c){let e=Math.floor((s.getTime()-c.getTime())/864e5),t=Math.floor(e/7);a=t%2==0,console.log("Biweekly: date=".concat(s.toDateString(),", daysSinceFirst=").concat(e,", weeksSinceFirst=").concat(t,", shouldCreate=").concat(a))}else console.log("No firstOccurrenceDate found for biweekly");else if("monthly"===e.frequency){let e=s.getMonth(),l=s.getFullYear(),n="".concat(l,"-").concat(e);"".concat(n,"-").concat(t),a=!i.find(a=>{let i=new Date(a.start),n=i.getMonth(),r=i.getFullYear(),o=b(m(i));return n===e&&r===l&&o===t})}if(a&&function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2];let a=new Date;a.setHours(0,0,0,0);let i=new Date(t);if(i.setHours(0,0,0,0),i<a)return!1;if("never"===e.frequency||"never"===e.ends)return!0;if("on_date"===e.ends&&e.endDate){let a=new Date(e.endDate);return a.setHours(23,59,59,999),t<=a}return!0}(e,s,o)){let t=h(e,s);if(t&&(i.push(t),o++,"after_occurrences"===e.ends&&e.occurrences)){let t=!1;if("weekly"===e.frequency)t=o>=e.occurrences;else if("biweekly"===e.frequency){let a=Math.ceil(o/e.days.length);t=a>=e.occurrences,console.log("Biweekly occurrence check: occurrenceCount=".concat(o,", days.length=").concat(e.days.length,", weeksCompleted=").concat(a,", shouldStop=").concat(t))}else"monthly"===e.frequency&&(t=Math.ceil(o/e.days.length)>=e.occurrences);if(t){console.log("Stopping due to occurrence limit: ".concat(e.occurrences));break}}}}s=new Date(s.getTime()+864e5)}return i}(e,t,a);i.push(...l)}):console.warn("convertAvailabilitySlotsToEvents: slots is not an array:",e),i}function h(e,t){let a=new Date(t),i=new Date(t),[l,n]=e.startTime.split(":").map(Number);a.setHours(l,n,0,0);let[r,o]=e.endTime.split(":").map(Number);return i.setHours(r,o,0,0),console.log("createEventFromSlot:",{slotId:e.id,date:t.toDateString(),startTime:e.startTime,endTime:e.endTime,eventStart:a.toISOString(),eventEnd:i.toISOString(),startHour:l,startMinute:n,endHour:r,endMinute:o}),{id:"".concat(e.id,"-").concat(t.toISOString().split("T")[0]),title:e.notes?"Available: ".concat(e.notes):"Available",start:a,end:i,allDay:!1,status:"AVAILABLE",eventType:"availability",isRecurring:"never"!==e.frequency,recurrenceRule:function(e){if("never"===e.frequency)return"";let t="weekly"===e.frequency||"biweekly"===e.frequency?"WEEKLY":"monthly"===e.frequency?"MONTHLY":"DAILY",a="biweekly"===e.frequency?2:1,i="FREQ=".concat(t,";INTERVAL=").concat(a);if(e.days.length>0){let t=e.days.map(e=>e.toUpperCase().substring(0,2)).join(",");i+=";BYDAY=".concat(t)}return"on_date"===e.ends&&e.endDate?i+=";UNTIL=".concat(e.endDate.replace(/-/g,""),"T235959Z"):"after_occurrences"===e.ends&&e.occurrences&&(i+=";COUNT=".concat(e.occurrences)),i}(e),originalSlotId:e.id,notes:e.notes}}function m(e){return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][e.getDay()]}function b(e){return({Mon:"monday",Tue:"tuesday",Wed:"wednesday",Thu:"thursday",Fri:"friday",Sat:"saturday",Sun:"sunday",monday:"monday",tuesday:"tuesday",wednesday:"wednesday",thursday:"thursday",friday:"friday",saturday:"saturday",sunday:"sunday"})[e]||e}var g=a(54416),_=a(10528),w=a.n(_);let p=e=>{let{isOpen:t,onClose:a,formData:n,onSave:r}=e,[o,s]=(0,l.useState)(n);l.useEffect(()=>{s(n)},[n]);let[c,d]=(0,l.useState)(!1),[u,y]=(0,l.useState)(!1),v=["M","Tu","W","Th","F","Sa","Su"],f=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],h=e=>{let t=f[v.indexOf(e)];s(e=>({...e,days:e.days.includes(t)?e.days.filter(e=>e!==t):[...e.days,t]}))};return t?(0,i.jsxs)("div",{className:w().overlay,onClick:a,children:[(0,i.jsxs)("div",{className:w().repeatSheet,onClick:e=>e.stopPropagation(),children:[(0,i.jsx)("div",{className:w().repeatHeader,children:(0,i.jsx)("h3",{children:"Repeat availability"})}),(0,i.jsxs)("div",{className:w().repeatContent,children:["never"===o.frequency?(0,i.jsxs)("div",{className:w().singleDateSection,children:[(0,i.jsx)("label",{className:w().sectionLabel,children:"Date"}),(0,i.jsx)("div",{className:w().dateInput,children:(0,i.jsx)("input",{type:"date",value:o.endDate||"",onChange:e=>s(t=>({...t,endDate:e.target.value})),className:w().datePicker})})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:w().startDateSection,children:[(0,i.jsx)("label",{className:w().sectionLabel,children:"Date"}),(0,i.jsx)("div",{className:w().dateInput,children:(0,i.jsx)("input",{type:"date",value:o.startDate||new Date().toISOString().split("T")[0],onChange:e=>s(t=>({...t,startDate:e.target.value})),className:w().datePicker})})]}),(0,i.jsxs)("div",{className:w().daysSection,children:[(0,i.jsx)("label",{className:w().sectionLabel,children:"Days"}),(0,i.jsx)("div",{className:w().daysGrid,children:v.map((e,t)=>{let a=f[t],l=o.days.includes(a);return(0,i.jsx)("button",{className:"".concat(w().dayButton," ").concat(l?w().dayButtonSelected:""),onClick:()=>h(e),children:e},e)})})]})]}),(0,i.jsxs)("div",{className:w().frequencySection,children:[(0,i.jsx)("label",{className:w().sectionLabel,children:"Frequency"}),(0,i.jsx)("div",{className:w().frequencyInput,onClick:()=>d(!0),children:(()=>{switch(o.frequency){case"never":default:return"No repeat";case"weekly":return"Every 1 week";case"biweekly":return"Every 2 weeks";case"monthly":return"Every 1 month"}})()})]}),(0,i.jsxs)("div",{className:w().endsSection,children:[(0,i.jsx)("label",{className:w().sectionLabel,children:"Ends"}),(0,i.jsx)("div",{className:w().endsInput,onClick:()=>y(!0),children:(()=>{switch(o.ends){case"never":default:return"Never";case"on_date":return o.endDate?"Until ".concat(new Date(o.endDate).toLocaleDateString()):"Select end date";case"after_occurrences":return o.occurrences?"After ".concat(o.occurrences," times"):"Select number of times"}})()})]})]}),(0,i.jsxs)("div",{className:w().repeatActions,children:[(0,i.jsx)("button",{className:w().cancelButton,onClick:a,children:"Cancel"}),(0,i.jsx)("button",{className:w().saveButton,onClick:()=>{r(o)},children:"Save"})]})]}),c&&(0,i.jsx)(D,{isOpen:c,onClose:()=>d(!1),title:"Select Frequency",options:[{label:"No repeat",value:"never"},{label:"Every Week",value:"weekly"},{label:"Every Two Weeks",value:"biweekly"},{label:"Every Month",value:"monthly"}],selectedValue:o.frequency,onSelect:e=>{s(t=>"never"===e?{...t,frequency:e,days:[],endDate:new Date().toISOString().split("T")[0],startDate:void 0,ends:"on_date"}:"never"===t.frequency&&"never"!==e?{...t,frequency:e,startDate:t.startDate||new Date().toISOString().split("T")[0],endDate:void 0,ends:"never"}:"never"===e||t.startDate?{...t,frequency:e}:{...t,frequency:e,startDate:t.startDate||new Date().toISOString().split("T")[0]}),d(!1)}}),u&&(0,i.jsx)(x,{isOpen:u,onClose:()=>y(!1),localData:o,onUpdate:e=>{s(e),y(!1)}})]}):null},D=e=>{let{isOpen:t,onClose:a,title:l,options:n,selectedValue:r,onSelect:o}=e;return t?(0,i.jsx)("div",{className:w().overlay,onClick:a,children:(0,i.jsxs)("div",{className:w().optionModal,onClick:e=>e.stopPropagation(),children:[(0,i.jsx)("div",{className:w().optionHeader,children:(0,i.jsx)("h3",{children:l})}),(0,i.jsx)("div",{className:w().optionContent,children:n.map(e=>(0,i.jsxs)("button",{className:"".concat(w().optionButton," ").concat(r===e.value?w().optionSelected:""),onClick:()=>o(e.value),children:[(0,i.jsx)("div",{className:w().radioButton,children:r===e.value&&(0,i.jsx)("div",{className:w().radioSelected})}),(0,i.jsx)("span",{children:e.label})]},e.value))}),(0,i.jsx)("div",{className:w().optionActions,children:(0,i.jsx)("button",{className:w().confirmButton,onClick:a,children:"Confirm"})})]})}):null},x=e=>{let{isOpen:t,onClose:a,localData:n,onUpdate:r}=e,[o,s]=(0,l.useState)(n);l.useEffect(()=>{s(n)},[n]);let c=e=>{s(t=>({...t,ends:e}))};return t?(0,i.jsx)("div",{className:w().overlay,onClick:a,children:(0,i.jsxs)("div",{className:w().optionModal,onClick:e=>e.stopPropagation(),children:[(0,i.jsx)("div",{className:w().optionHeader,children:(0,i.jsx)("h3",{children:"When does this end?"})}),(0,i.jsxs)("div",{className:w().optionContent,children:[(0,i.jsxs)("button",{className:"".concat(w().optionButton," ").concat("never"===o.ends?w().optionSelected:""),onClick:()=>c("never"),children:[(0,i.jsx)("div",{className:w().radioButton,children:"never"===o.ends&&(0,i.jsx)("div",{className:w().radioSelected})}),(0,i.jsx)("span",{children:"Never"})]}),(0,i.jsxs)("button",{className:"".concat(w().optionButton," ").concat("on_date"===o.ends?w().optionSelected:""),onClick:()=>c("on_date"),children:[(0,i.jsx)("div",{className:w().radioButton,children:"on_date"===o.ends&&(0,i.jsx)("div",{className:w().radioSelected})}),(0,i.jsx)("span",{children:"On a specific date"})]}),"on_date"===o.ends&&(0,i.jsx)("div",{className:w().dateInputContainer,children:(0,i.jsx)("input",{type:"date",value:o.endDate||"",onChange:e=>s(t=>({...t,endDate:e.target.value})),className:w().dateInput,min:new Date().toISOString().split("T")[0]})}),(0,i.jsxs)("button",{className:"".concat(w().optionButton," ").concat("after_occurrences"===o.ends?w().optionSelected:""),onClick:()=>c("after_occurrences"),children:[(0,i.jsx)("div",{className:w().radioButton,children:"after_occurrences"===o.ends&&(0,i.jsx)("div",{className:w().radioSelected})}),(0,i.jsx)("span",{children:"After a number of times"})]}),"after_occurrences"===o.ends&&(0,i.jsxs)("div",{className:w().occurrencesInputContainer,children:[(0,i.jsx)("input",{type:"number",value:o.occurrences||"",onChange:e=>s(t=>({...t,occurrences:parseInt(e.target.value)||1})),className:w().occurrencesInput,min:"1",max:"100",placeholder:"Number of times"}),(0,i.jsx)("span",{className:w().occurrencesLabel,children:"times"})]})]}),(0,i.jsxs)("div",{className:w().optionActions,children:[(0,i.jsx)("button",{className:w().cancelButton,onClick:a,children:"Cancel"}),(0,i.jsx)("button",{className:w().confirmButton,onClick:()=>{r(o)},children:"Save"})]})]})}):null},S=e=>{let{isOpen:t,onClose:a,slot:n,onSave:r,onDelete:o,selectedDate:s,selectedTime:c,isEditingSingleOccurrence:d=!1}=e,[u,y]=(0,l.useState)({startTime:"09:00",endTime:"19:00",days:[],frequency:"never",ends:"never"}),[v,f]=(0,l.useState)(!1),h=e=>{let[t,a]=e.split(":").map(Number);return"".concat(((t+1)%24).toString().padStart(2,"0"),":").concat(a.toString().padStart(2,"0"))};return((0,l.useEffect)(()=>{if(n)d&&s?y({startTime:n.startTime,endTime:n.endTime,days:[],frequency:"never",ends:"on_date",endDate:s.toISOString().split("T")[0],occurrences:void 0}):y({startTime:n.startTime,endTime:n.endTime,days:n.days,frequency:n.frequency,ends:n.ends,endDate:n.endDate,occurrences:n.occurrences});else if(s){let e=s.toISOString().split("T")[0];y(t=>({...t,days:[],endDate:e,frequency:"never",startTime:c||"09:00",endTime:c?h(c):"19:00"}))}},[n,s,c,d]),t)?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:w().overlay,onClick:a,children:(0,i.jsxs)("div",{className:w().modal,onClick:e=>e.stopPropagation(),children:[(0,i.jsxs)("div",{className:w().header,children:[(0,i.jsx)("h2",{className:w().title,children:n?"Edit availability":"New availability slot"}),(0,i.jsx)("button",{className:w().closeButton,onClick:a,children:(0,i.jsx)(g.A,{size:20})})]}),(0,i.jsxs)("div",{className:w().content,children:[(0,i.jsxs)("div",{className:w().formGroup,children:[(0,i.jsx)("label",{className:w().label,children:"Start time"}),(0,i.jsx)("input",{type:"time",value:u.startTime,onChange:e=>y(t=>({...t,startTime:e.target.value})),className:w().timeInput})]}),(0,i.jsxs)("div",{className:w().formGroup,children:[(0,i.jsx)("label",{className:w().label,children:"End time"}),(0,i.jsx)("input",{type:"time",value:u.endTime,onChange:e=>y(t=>({...t,endTime:e.target.value})),className:w().timeInput})]}),(0,i.jsxs)("div",{className:w().recurrenceRow,onClick:()=>f(!0),children:[(0,i.jsx)("span",{className:w().recurrenceText,children:(()=>{if("never"===u.frequency){if(u.endDate){let e=new Date(u.endDate);return"Single occurrence on ".concat(e.toLocaleDateString("en-GB",{weekday:"long",day:"2-digit",month:"short",year:"numeric"}))}return"Single occurrence (date not specified)"}if(0===u.days.length)return"No recurrence set";let e=u.days.join("-"),t="weekly"===u.frequency?"week":"biweekly"===u.frequency?"2 weeks":"month";return"Repeats ".concat(e," every ").concat(t)})()}),(0,i.jsx)("span",{className:w().arrow,children:"›"})]})]}),(0,i.jsxs)("div",{className:w().actions,children:[(0,i.jsx)("button",{className:w().cancelButton,onClick:a,children:"Cancel"}),(0,i.jsx)("button",{className:w().saveButton,onClick:()=>{r(u),a()},children:"Save"}),n&&o&&(0,i.jsx)("button",{className:w().deleteButton,onClick:o,children:"Delete"})]})]})}),v&&(0,i.jsx)(p,{isOpen:v,onClose:()=>f(!1),formData:u,onSave:e=>{y(e),f(!1)}})]}):null};var A=a(26977),k=a.n(A);let N=e=>{let{isOpen:t,onClose:a,onConfirm:l}=e;return t?(0,i.jsx)("div",{className:k().overlay,onClick:a,children:(0,i.jsxs)("div",{className:k().alertDialog,onClick:e=>e.stopPropagation(),children:[(0,i.jsx)("div",{className:k().alertHeader,children:(0,i.jsx)("h3",{children:"Clear availability?"})}),(0,i.jsx)("div",{className:k().alertContent,children:(0,i.jsx)("p",{children:"This action cannot be undone."})}),(0,i.jsxs)("div",{className:k().alertActions,children:[(0,i.jsx)("button",{className:k().cancelButton,onClick:a,children:"Cancel"}),(0,i.jsx)("button",{className:k().clearButton,onClick:l,children:"Clear"})]})]})}):null};var j=a(82940),C=a.n(j),M=a(34900),T=a.n(M);let B=e=>{let{events:t,availabilitySlots:a,currentDate:n,onEventClick:r,onDateSelect:o,onAvailabilityEdit:s,onAvailabilityDelete:c,onClearAll:d}=e,[u,y]=(0,l.useState)(null);l.useEffect(()=>{let e=e=>{u&&y(null)};if(u)return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[u]);let v=C()(n).startOf("isoWeek"),f=Array.from({length:7},(e,t)=>C()(v).add(t,"days").toDate()),h=Array.from({length:18},(e,t)=>t+6),m=e=>Array.isArray(a)?a.filter(t=>{if("never"===t.frequency&&t.endDate)return new Date(t.endDate).toDateString()===e.toDateString();C()(e).format("ddd");let a=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"][C()(e).isoWeekday()-1];if(!t.days.includes(a))return!1;let i=t.startDate?new Date(t.startDate):t.createdAt?new Date(t.createdAt):new Date;i.setHours(0,0,0,0);let l=new Date(e);if(l.setHours(0,0,0,0),l<i)return!1;if("on_date"===t.ends&&t.endDate){let e=new Date(t.endDate);if(e.setHours(23,59,59,999),l>e)return!1}if("after_occurrences"===t.ends&&t.occurrences){if("weekly"===t.frequency){let e=t.startDate?new Date(t.startDate):t.createdAt?new Date(t.createdAt):new Date;e.setHours(0,0,0,0);let a=null,i=new Date(e);for(;i<=l;){C()(i).format("ddd");let e=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"][C()(i).isoWeekday()-1];if(t.days.includes(e)){a=new Date(i);break}i=new Date(i.getTime()+864e5)}if(a&&Math.floor(Math.floor((l.getTime()-a.getTime())/864e5)/7)>=t.occurrences)return!1}else if(b(t,e)>=t.occurrences)return!1}return!0}):(console.warn("WeeklyAvailabilityView: availabilitySlots is not an array:",a),[]),b=(e,t)=>{if("never"===e.frequency)return 0;let a=e.startDate?new Date(e.startDate):e.createdAt?new Date(e.createdAt):new Date;a.setHours(0,0,0,0);let i=new Date(t);i.setHours(23,59,59,999);let l=0,n=new Date(a);for(;n<=i;){C()(n).format("ddd");let t=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"][C()(n).isoWeekday()-1];e.days.includes(t)&&l++,n=new Date(n.getTime()+864e5)}return l},g=e=>{o&&o(e)},_=(e,t,a)=>{e.preventDefault(),e.stopPropagation();let i=window.innerWidth,l=window.innerHeight,n=e.clientX,r=e.clientY;n+120>i&&(n=i-120-10),r+120>l&&(r=l-120-10),y({x:n=Math.max(10,n),y:r=Math.max(10,r),slot:t,clickedDay:a})},w=e=>{if(u){switch(e){case"edit":let t=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"][C()(u.clickedDay).isoWeekday()-1];s({...u.slot,days:[t],frequency:"never",ends:"never"});break;case"repeat":s(u.slot);break;case"delete":c(u.slot)}y(null)}},p=(e,t)=>{let a="".concat(t.toString().padStart(2,"0"),":00"),i=new Date(e);i.setHours(t,0,0,0),o(i,a)},D=(e,t)=>m(e).filter(e=>{let a=parseInt(e.startTime.split(":")[0]),i=parseInt(e.endTime.split(":")[0]);return t>=a&&t<i}),x=(e,t)=>{let a=parseInt(e.startTime.split(":")[0]),i=parseInt(e.endTime.split(":")[0]),l=parseInt(e.startTime.split(":")[1]);return{startHour:a,endHour:i,startPosition:l/60*100,endPosition:parseInt(e.endTime.split(":")[1])/60*100,totalHours:i-a+1}};return(0,i.jsxs)("div",{className:T().weekViewContainer,children:[(0,i.jsxs)("div",{className:T().header,children:[(0,i.jsx)("div",{className:T().timeColumn}),f.map(e=>(0,i.jsxs)("div",{className:T().dayHeader,onClick:()=>g(e),children:[(0,i.jsx)("div",{className:T().dayName,children:C()(e).format("ddd")}),(0,i.jsx)("div",{className:T().dayNumber,children:C()(e).format("D")})]},"day-".concat(C()(e).format("YYYY-MM-DD"))))]}),(0,i.jsx)("div",{className:T().timeGrid,children:h.map(e=>(0,i.jsxs)("div",{className:T().timeRow,children:[(0,i.jsx)("div",{className:T().timeLabel,children:C()().startOf("day").add(e,"hours").format("HH:mm")}),f.map(t=>{let a=D(t,e);return(0,i.jsx)("div",{className:T().timeSlot,onClick:()=>p(t,e),children:a.filter(t=>parseInt(t.startTime.split(":")[0])===e).map((e,a)=>{let l=x(e,t),n=60*l.totalHours,r=.6*l.startPosition,o=(100-l.endPosition)*.6;return(0,i.jsx)("div",{className:T().availabilityBlock,onClick:a=>_(a,e,t),style:{backgroundColor:"#10b981",height:"".concat(Math.max(n-r-o,20),"px"),margin:"0",borderRadius:"4px",position:"absolute",top:"".concat(r,"px"),left:"0px",right:"0px",zIndex:1,cursor:"pointer",transition:"all 0.2s ease",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)",userSelect:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",outline:"none",display:"flex",alignItems:"center",justifyContent:"center",gap:"5px",padding:"2px 6px",flexDirection:"column"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#059669",e.currentTarget.style.transform="scale(1.02)",e.currentTarget.style.boxShadow="0 4px 12px rgba(16, 185, 129, 0.3)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="#10b981",e.currentTarget.style.transform="scale(1)",e.currentTarget.style.boxShadow="0 2px 4px rgba(0, 0, 0, 0.1)"},children:(0,i.jsx)("span",{style:{fontSize:"2.5vw",color:"#ffffff",fontWeight:"600",whiteSpace:"nowrap"},children:"Available"})},"availability-".concat(a,"-").concat(C()(t).format("YYYY-MM-DD-HH-mm")))})},"slot-".concat(C()(t).format("YYYY-MM-DD"),"-").concat(e))})]},e))}),u&&(0,i.jsxs)("div",{className:T().contextMenu,style:{position:"fixed",left:u.x,top:u.y,zIndex:1e3,backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 10px 25px rgba(0, 0, 0, 0.15)",padding:"8px 0",minWidth:"120px"},onClick:e=>e.stopPropagation(),children:[(0,i.jsx)("button",{onClick:()=>w("edit"),style:{display:"block",width:"100%",padding:"8px 16px",border:"none",background:"none",textAlign:"left",cursor:"pointer",fontSize:"14px",color:"#374151",transition:"background-color 0.2s"},onMouseEnter:e=>e.currentTarget.style.backgroundColor="#f3f4f6",onMouseLeave:e=>e.currentTarget.style.backgroundColor="transparent",children:"Edit This Day"}),(0,i.jsx)("button",{onClick:()=>w("repeat"),style:{display:"block",width:"100%",padding:"8px 16px",border:"none",background:"none",textAlign:"left",cursor:"pointer",fontSize:"14px",color:"#374151",transition:"background-color 0.2s"},onMouseEnter:e=>e.currentTarget.style.backgroundColor="#f3f4f6",onMouseLeave:e=>e.currentTarget.style.backgroundColor="transparent",children:"Edit Recurring"}),(0,i.jsx)("button",{onClick:()=>w("delete"),style:{display:"block",width:"100%",padding:"8px 16px",border:"none",background:"none",textAlign:"left",cursor:"pointer",fontSize:"14px",color:"#ef4444",transition:"background-color 0.2s"},onMouseEnter:e=>e.currentTarget.style.backgroundColor="#fef2f2",onMouseLeave:e=>e.currentTarget.style.backgroundColor="transparent",children:"Delete"})]}),(0,i.jsx)("button",{className:T().clearButton,onClick:d,title:"Clear all availability",children:"\uD83D\uDDD1️"})]})};var I=a(30100),E=a.n(I);let W=e=>{let{events:t,availabilitySlots:a,currentDate:n,onEventClick:r,onDateSelect:o,onAvailabilityEdit:s,onAvailabilityDelete:c,onClearAll:d,selectedDate:u}=e,[y,v]=(0,l.useState)(null),f=Array.from({length:18},(e,t)=>t+6),h=e=>["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][e.getDay()],m=(e,t)=>{if("never"===e.frequency)return 0;let a=e.startDate?new Date(e.startDate):e.createdAt?new Date(e.createdAt):new Date;a.setHours(0,0,0,0);let i=new Date(t);i.setHours(23,59,59,999);let l=0,n=new Date(a);for(;n<=i;){let t=b(h(n));e.days.includes(t)&&l++,n=new Date(n.getTime()+864e5)}return l},b=e=>({Mon:"monday",Tue:"tuesday",Wed:"wednesday",Thu:"thursday",Fri:"friday",Sat:"saturday",Sun:"sunday",monday:"monday",tuesday:"tuesday",wednesday:"wednesday",thursday:"thursday",friday:"friday",saturday:"saturday",sunday:"sunday"})[e]||e,g=e=>{let[t]=e.split(":").map(Number);return(t-6)/18*100},_=(e,t)=>{let[a,i]=e.split(":").map(Number),[l,n]=t.split(":").map(Number);return(60*l+n-(60*a+i))/60*(100/18)},w=(e,t)=>{e.preventDefault(),v({x:e.clientX,y:e.clientY,slot:t})},p=e=>{if(y){switch(e){case"edit":case"repeat":s(y.slot);break;case"delete":c(y.slot)}v(null)}},D=e=>{let t=new Date(u);t.setHours(e,0,0,0),o(t,"".concat(e.toString().padStart(2,"0"),":00"))},x=(e=>Array.isArray(a)?a.filter(t=>{if("never"===t.frequency&&t.endDate)return new Date(t.endDate).toDateString()===e.toDateString();let a=h(e);if(!t.days.includes(a))return!1;let i=t.startDate?new Date(t.startDate):t.createdAt?new Date(t.createdAt):new Date;i.setHours(0,0,0,0);let l=new Date(e);if(l.setHours(0,0,0,0),l<i)return!1;if("on_date"===t.ends&&t.endDate){let e=new Date(t.endDate);if(e.setHours(23,59,59,999),l>e)return!1}if("after_occurrences"===t.ends&&t.occurrences){if("weekly"===t.frequency){let e=t.startDate?new Date(t.startDate):t.createdAt?new Date(t.createdAt):new Date;e.setHours(0,0,0,0);let a=null,i=new Date(e);for(;i<=l;){let e=b(h(i));if(t.days.map(e=>b(e)).includes(e)){a=new Date(i);break}i=new Date(i.getTime()+864e5)}if(a&&Math.floor(Math.floor((l.getTime()-a.getTime())/864e5)/7)>=t.occurrences)return!1}else if(m(t,e)>=t.occurrences)return!1}return!0}):(console.warn("DailyAvailabilityView: availabilitySlots is not an array:",a),[]))(u);return(0,i.jsxs)("div",{className:E().container,children:[(0,i.jsxs)("div",{className:E().header,children:[(0,i.jsx)("div",{className:E().timeHeader,children:(0,i.jsx)("span",{children:"TIME"})}),(0,i.jsxs)("div",{className:E().dayHeader,children:[(0,i.jsx)("div",{className:E().dayName,children:h(u)}),(0,i.jsx)("div",{className:E().dayNumber,children:u.toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})})]})]}),(0,i.jsxs)("div",{className:E().timeGrid,children:[(0,i.jsx)("div",{className:E().timeColumn,children:f.map(e=>(0,i.jsx)("div",{className:E().timeLabel,children:12===e?"12 PM":e>12?"".concat(e-12," PM"):"".concat(e," AM")},e))}),(0,i.jsx)("div",{className:E().availabilityColumn,children:f.map((e,t)=>{let a=x.find(t=>{let a=parseInt(t.startTime.split(":")[0]),i=parseInt(t.endTime.split(":")[0]);return e>=a&&e<i});if(a){if(e===parseInt(a.startTime.split(":")[0])){let e=_(a.startTime,a.endTime);return(0,i.jsx)("div",{className:E().availabilityBlock,style:{top:"".concat(g(a.startTime),"%"),height:"".concat(e,"%")},onClick:e=>w(e,a),children:(0,i.jsxs)("div",{className:E().availabilityContent,children:[(0,i.jsxs)("div",{className:E().availabilityTime,children:[a.startTime," - ",a.endTime]}),(0,i.jsx)("div",{className:E().availabilityStatus,children:"Available"})]})},t)}return null}return(0,i.jsx)("div",{className:E().emptySlot,onClick:()=>D(e)},t)})})]}),y&&(0,i.jsxs)("div",{className:E().contextMenu,style:{left:y.x,top:y.y},children:[(0,i.jsx)("button",{onClick:()=>p("edit"),children:"Edit This Day"}),(0,i.jsx)("button",{onClick:()=>p("repeat"),children:"Edit Recurring"}),(0,i.jsx)("button",{onClick:()=>p("delete"),className:E().deleteOption,children:"Delete"})]}),(0,i.jsx)("button",{className:E().clearButton,onClick:d,title:"Clear all availability",children:"\uD83D\uDDD1️"})]})};var V=a(86332),H=a.n(V);let O=e=>{let{events:t,availabilitySlots:a,currentDate:n,onEventClick:r,onDateSelect:o,onAvailabilityEdit:s,onAvailabilityDelete:c,onClearAll:d,selectedDate:u}=e,[y,v]=(0,l.useState)(u),f=e=>["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][e.getDay()],h=e=>{if(console.log("getAvailabilityForDay called for date:",e.toDateString()),console.log("Available slots:",a),!Array.isArray(a))return console.warn("MonthlyAvailabilityView: availabilitySlots is not an array:",a),[];console.log("Slot details:",a.map(e=>({id:e.id,frequency:e.frequency,days:e.days,ends:e.ends,occurrences:e.occurrences,createdAt:e.createdAt}))),console.log("Raw slot data:",JSON.stringify(a,null,2));let t=a.filter(t=>{if("never"===t.frequency&&t.endDate){let a=new Date(t.endDate),i=a.toDateString()===e.toDateString();return console.log("Single occurrence check:",{slotDate:a.toDateString(),date:e.toDateString(),matches:i}),i}let a=f(e),i=m(a),l=t.days.map(e=>m(e));if(!l.includes(i))return console.log("Recurring check - day not in slot:",{dayName:a,slotDays:t.days,matches:!1}),!1;if("biweekly"===t.frequency){let a=t.startDate?new Date(t.startDate):t.createdAt?new Date(t.createdAt):new Date;a.setHours(0,0,0,0);let i=null,n=new Date(a),r=new Date(e);for(r.setHours(0,0,0,0);n<=r;){let e=m(f(n));if(l.includes(e)){i=new Date(n);break}n=new Date(n.getTime()+864e5)}if(!i)return console.log("Bi-weekly display - no first occurrence found for date:",e.toDateString()),!1;{let t=Math.floor((r.getTime()-i.getTime())/864e5),a=Math.floor(t/7),l=a%2==0;if(console.log("Bi-weekly display check:",{date:e.toDateString(),firstOccurrence:i.toDateString(),weeksSinceFirst:a,shouldShowThisWeek:l,daysSinceFirst:t}),!l)return console.log("Bi-weekly display - skipping week:",{date:e.toDateString(),weeksSinceFirst:a}),!1}}let n=new Date;n.setHours(0,0,0,0);let r=new Date(e);if(r.setHours(0,0,0,0),r<n)return console.log("Recurring check - date in past:",{date:r.toDateString(),today:n.toDateString(),matches:!1}),!1;if("weekly"===t.frequency){let a=t.startDate?new Date(t.startDate):t.createdAt?new Date(t.createdAt):new Date;a.setHours(0,0,0,0);let i=null,n=new Date(a);for(;n<=r;){let e=m(f(n));if(l.includes(e)){i=new Date(n);break}n=new Date(n.getTime()+864e5)}if(!i)return console.log("Weekly display - no first occurrence found for date:",e.toDateString()),!1;{let a=Math.floor(Math.floor((r.getTime()-i.getTime())/864e5)/7);if(console.log("Weekly display check:",{date:e.toDateString(),firstOccurrence:i.toDateString(),weeksSinceFirst:a}),t.occurrences&&a>=t.occurrences)return console.log("Weekly display - occurrence limit reached:",{weeksSinceFirst:a,maxOccurrences:t.occurrences}),!1}}if("monthly"===t.frequency){let a=t.startDate?new Date(t.startDate):t.createdAt?new Date(t.createdAt):new Date;a.setHours(0,0,0,0);let i=null,n=new Date(a);for(;n<=r;){let e=m(f(n));if(l.includes(e)){i=new Date(n);break}n=new Date(n.getTime()+864e5)}if(!i)return console.log("Monthly display - no first occurrence found for date:",e.toDateString()),!1;{let a=(r.getFullYear()-i.getFullYear())*12+(r.getMonth()-i.getMonth());if(console.log("Monthly display check:",{date:e.toDateString(),firstOccurrence:i.toDateString(),monthsSinceFirst:a}),t.occurrences&&a>=t.occurrences)return console.log("Monthly display - occurrence limit reached:",{monthsSinceFirst:a,maxOccurrences:t.occurrences}),!1;let l=i.getDay(),n=r.getDay();if(l!==n)return console.log("Monthly display - day of week mismatch:",{firstOccurrenceDayOfWeek:l,currentDayOfWeek:n,date:e.toDateString()}),!1;if(a<0)return console.log("Monthly display - date before first occurrence:",{monthsSinceFirst:a}),!1;let o=i.getDate(),s=r.getDate(),c=Math.ceil(o/7),d=Math.ceil(s/7);if(c!==d)return console.log("Monthly display - week of month mismatch:",{firstOccurrenceWeekOfMonth:c,currentWeekOfMonth:d,firstOccurrenceDayOfMonth:i.getDate(),currentDayOfMonth:r.getDate(),date:e.toDateString()}),!1;console.log("Monthly display - valid date:",{date:e.toDateString(),monthsSinceFirst:a,dayOfWeek:n,dayOfMonth:s,weekOfMonth:d})}}if("on_date"===t.ends&&t.endDate){let e=new Date(t.endDate);if(e.setHours(23,59,59,999),r>e)return console.log("Recurring check - date after end date:",{date:r.toDateString(),endDate:e.toDateString(),matches:!1}),!1}if(console.log("Checking occurrence limit:",{ends:t.ends,occurrences:t.occurrences,endsType:typeof t.ends,occurrencesType:typeof t.occurrences,endsMatches:"after_occurrences"===t.ends,occurrencesTruthy:!!t.occurrences}),("after_occurrences"===t.ends||"never"===t.ends&&t.occurrences)&&t.occurrences&&"biweekly"===t.frequency){let a=t.startDate?new Date(t.startDate):t.createdAt?new Date(t.createdAt):new Date;a.setHours(0,0,0,0);let i=null,l=new Date(a),n=new Date(e);for(n.setHours(0,0,0,0);l<=n;){let e=m(f(l));if(t.days.map(e=>m(e)).includes(e)){i=new Date(l);break}l=new Date(l.getTime()+864e5)}if(i){let a=Math.floor(Math.floor((n.getTime()-i.getTime())/864e5)/7),l=Math.floor(a/2)+1;if(console.log("Bi-weekly occurrence check:",{date:e.toDateString(),firstOccurrence:i.toDateString(),weeksSinceFirst:a,biWeeklyPeriods:l,maxOccurrences:t.occurrences,shouldShow:l<=t.occurrences}),l>t.occurrences)return console.log("Bi-weekly occurrence limit reached:",{biWeeklyPeriods:l,maxOccurrences:t.occurrences}),!1}}return console.log("Recurring check - valid:",{dayName:a,slotDays:t.days,matches:!0}),!0});return console.log("Result for date",e.toDateString(),":",t),t},m=e=>({Mon:"monday",Tue:"tuesday",Wed:"wednesday",Thu:"thursday",Fri:"friday",Sat:"saturday",Sun:"sunday",monday:"monday",tuesday:"tuesday",wednesday:"wednesday",thursday:"thursday",friday:"friday",saturday:"saturday",sunday:"sunday"})[e]||e,b=e=>h(e).length>0,g=e=>e.getMonth()===y.getMonth()&&e.getFullYear()===y.getFullYear(),_=e=>{let t=new Date;return e.toDateString()===t.toDateString()},w=e=>e.toDateString()===u.toDateString(),p=e=>{o(e)},D=(e=>{let t=e.getFullYear(),a=e.getMonth(),i=new Date(t,a,1),l=new Date(t,a+1,0),n=new Date(i);n.setDate(n.getDate()-i.getDay());let r=[],o=new Date(n);for(;o<=l||r.length<42;)r.push(new Date(o)),o.setDate(o.getDate()+1);return r})(y);return(0,i.jsxs)("div",{className:H().container,children:[(0,i.jsxs)("div",{className:H().header,children:[(0,i.jsx)("div",{className:H().monthInfo,children:(0,i.jsx)("h2",{className:H().monthTitle,children:y.toLocaleDateString("en-US",{month:"long",year:"numeric"})})}),(0,i.jsx)("button",{className:H().chooseDateButton,onClick:()=>o(u),children:"Choose a date"})]}),(0,i.jsxs)("div",{className:H().calendarGrid,children:[(0,i.jsx)("div",{className:H().dayHeaders,children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(e=>(0,i.jsx)("div",{className:H().dayHeader,children:e},e))}),(0,i.jsx)("div",{className:H().daysGrid,children:D.map((e,t)=>(0,i.jsxs)("button",{className:"".concat(H().dayCell," ").concat(!g(e)?H().otherMonth:""," ").concat(_(e)?H().today:""," ").concat(w(e)?H().selected:""," ").concat(b(e)?H().hasAvailability:""),onClick:()=>p(e),children:[(0,i.jsx)("span",{className:H().dayNumber,children:e.getDate()}),b(e)&&(0,i.jsx)("div",{className:H().availabilityIndicator})]},t))})]}),(0,i.jsxs)("div",{className:H().navigation,children:[(0,i.jsx)("button",{className:H().navButton,onClick:()=>{let e=new Date(y);e.setMonth(e.getMonth()-1),v(e)},children:"‹"}),(0,i.jsx)("button",{className:H().navButton,onClick:()=>{let e=new Date(y);e.setMonth(e.getMonth()+1),v(e)},children:"›"})]}),(0,i.jsx)("button",{className:H().clearButton,onClick:d,title:"Clear all availability",children:"\uD83D\uDDD1️"})]})};var q=a(43866),F=a.n(q),P=a(6188),R=a(51178),L=a(69404),Y=a(46083);let G=["Manage availability","Accepted gigs","See gig offers"];function U(e,t){switch(t){case"Manage availability":return e.filter(e=>"AVAILABLE"===e.status);case"Accepted gigs":return e.filter(e=>"ACCEPTED"===e.status);case"See gig offers":return e.filter(e=>"OFFER"===e.status);default:return e}}async function z(e,t){console.log("Fetching worker data for workerId:",e,"with filters:",t);let a=await (0,R.g)(e);if(a.error)throw Error(a.error);if(!a.data)throw Error("No data received from server");return a.data}let Q=()=>{let e=(0,n.usePathname)(),t=(0,n.useRouter)(),y=(0,n.useParams)().userId,{user:h,loading:m}=(0,d.A)(),b=null==h?void 0:h.uid,[g,_]=(0,l.useState)(()=>window.innerWidth<768?"day":"week"),[w,p]=(0,l.useState)(new Date),[D,x]=(0,l.useState)(G[2]),[A,k]=(0,l.useState)([]),[j,C]=(0,l.useState)([]),[M,T]=(0,l.useState)(null),[I,E]=(0,l.useState)(!1),[V,H]=(0,l.useState)(!1),[q,R]=(0,l.useState)([]),[Q,X]=(0,l.useState)(!1),[J,Z]=(0,l.useState)(null),[K,$]=(0,l.useState)(null),[ee,et]=(0,l.useState)(null),[ea,ei]=(0,l.useState)(!1),[el,en]=(0,l.useState)(!1),[er,eo]=(0,l.useState)(!1),[es,ec]=(0,l.useState)(null),[ed,eu]=(0,l.useState)(null),[ey,ev]=(0,l.useState)([]),[ef,eh]=(0,l.useState)([]);(0,l.useEffect)(()=>{if(!m){if(!h)return void t.push("/signin?redirect=".concat(e));if(b!==y)return void t.push("/signin?error=unauthorized")}},[m]),(0,l.useEffect)(()=>{(async()=>{if(h)try{let e=await (0,u.O)({userId:h.uid,role:"worker",isViewQA:!1});if(e.error)throw Error(e.error);let t=await v(h.uid);t.error&&console.error("Error fetching availability:",t.error),console.log("availabilityRes:",t),console.log("availabilityRes.availability:",t.availability),console.log("typeof availabilityRes.availability:",typeof t.availability),console.log("Array.isArray(availabilityRes.availability):",Array.isArray(t.availability)),console.log("availabilityRes:",t),console.log("availabilityRes.availability:",t.availability),console.log("typeof availabilityRes.availability:",typeof t.availability),console.log("Array.isArray(availabilityRes.availability):",Array.isArray(t.availability));let a=e.events.map(e=>({...e,start:new Date(e.start),end:new Date(e.end)})),i=f(t.availability||[],new Date(w.getFullYear(),w.getMonth(),1),new Date(w.getFullYear(),w.getMonth()+1,0)),l=[...a,...i];C(l);let n=Array.isArray(t.availability)?t.availability:t.availability?[t.availability]:[];R(n);let r=U(l,D);k(r)}catch(e){console.error("Error fetching events:",e)}})()},[h,D,w]),(0,l.useEffect)(()=>{!m&&h&&b===y&&(console.log("Debug - User authorized, fetching worker data..."),z(y).then(e=>{console.log("Debug - offer received:",e),ev(e.offers),eh(e.acceptedGigs)}).catch(e=>{console.error("Error fetching worker data:",e),ev([]),eh([])}))},[h,m,b,y]);let em=e=>{if("AVAILABLE"===e.status){let t=Array.isArray(q)?q.find(t=>t.id===e.originalSlotId):null;t&&"never"!==t.frequency?(Z(t),$(e.start),eo(!0)):(Z(t||null),en(!1),X(!0))}else e.status,T(e),E(!0)},eb=async e=>{if(console.log("handleAvailabilitySave called with data:",e),console.log("handleAvailabilitySave data type:",typeof e),console.log("handleAvailabilitySave data keys:",Object.keys(e||{})),console.log("isEditingSingleOccurrence:",el),!h)return void console.log("No user found");try{let{testAvailabilityAction:e}=await a.e(2305).then(a.bind(a,32305));console.log("Testing server action...");let t=await e(h.uid);console.log("Test result:",t)}catch(e){console.error("Test action failed:",e)}try{if(J)if(el){console.log("Creating new single occurrence slot");let{createAvailabilitySlot:t}=await a.e(9186).then(a.bind(a,69186)),i=await t(h.uid,e);if(console.log("Create single occurrence result:",i),i.error){console.error("Create single occurrence failed:",i.error),alert("Failed to create single occurrence: ".concat(i.error));return}console.log("Successfully created single occurrence slot")}else{console.log("Updating existing slot:",J.id);let{updateAvailabilitySlot:t}=await a.e(9186).then(a.bind(a,69186)),i=await t(h.uid,J.id,e);if(console.log("Update result:",i),i.error){console.error("Update failed:",i.error),alert("Failed to update availability: ".concat(i.error));return}console.log("Successfully updated availability slot")}else{console.log("Creating new slot");let{createAvailabilitySlot:t}=await a.e(9186).then(a.bind(a,69186));console.log("createAvailabilitySlot function imported:",typeof t),console.log("About to call createAvailabilitySlot with:",{userId:h.uid,data:e}),console.log("createAvailabilitySlot function imported:",typeof t),console.log("About to call createAvailabilitySlot with:",{userId:h.uid,data:e});let i=await t(h.uid,e);if(console.log("Create result:",i),console.log("Create result type:",typeof i),console.log("Create result keys:",Object.keys(i||{})),i.error){console.error("Create failed:",i.error),console.error("Full result object:",i),console.error("Error details:",i.details),console.error("Error type:",i.errorType),alert("Failed to create availability: ".concat(i.error));return}console.log("Successfully created availability slot")}e_(),(async()=>{let e=await (0,u.O)({userId:h.uid,role:"worker",isViewQA:!1}),t=await v(h.uid),a=(e.events||[]).map(e=>({...e,start:new Date(e.start),end:new Date(e.end)})),i=f(t.availability||[],new Date(w.getFullYear(),w.getMonth(),1),new Date(w.getFullYear(),w.getMonth()+1,0)),l=[...a,...i];C(l);let n=Array.isArray(t.availability)?t.availability:t.availability?[t.availability]:[];R(n),k(U(l,D))})()}catch(e){console.error("Error saving availability:",e),alert("Error saving availability: ".concat(e instanceof Error?e.message:"Unknown error"))}},eg=async()=>{if(h&&J)try{let{deleteAvailabilitySlot:e}=await a.e(9186).then(a.bind(a,69186));await e(h.uid,J.id),e_(),(async()=>{let e=await (0,u.O)({userId:h.uid,role:"worker",isViewQA:!1}),t=await v(h.uid),a=(e.events||[]).map(e=>({...e,start:new Date(e.start),end:new Date(e.end)})),i=f(t.availability||[],new Date(w.getFullYear(),w.getMonth(),1),new Date(w.getFullYear(),w.getMonth()+1,0)),l=[...a,...i];C(l);let n=Array.isArray(t.availability)?t.availability:t.availability?[t.availability]:[];R(n),k(U(l,D))})()}catch(e){console.error("Error deleting availability:",e)}},e_=()=>{X(!1),Z(null),$(null),en(!1)},ew=()=>{eo(!1),Z(null),$(null)},ep=(e,t)=>{console.log("handleDateSelect called with:",{slotInfo:e,selectedTime:t}),"object"==typeof e&&"start"in e?(console.log("Setting selected date from slotInfo.start:",e.start),$(e.start),et(t||null),X(!0)):e instanceof Date&&(console.log("Setting selected date from Date:",e),$(e),et(t||null),X(!0)),console.log("Modal should now be open")},eD=async()=>{if(h)try{let{clearAllAvailability:e}=await a.e(9186).then(a.bind(a,69186));await e(h.uid),(async()=>{let e=await (0,u.O)({userId:h.uid,role:"worker",isViewQA:!1}),t=await v(h.uid),a=(e.events||[]).map(e=>({...e,start:new Date(e.start),end:new Date(e.end)})),i=f(t.availability||[],new Date(w.getFullYear(),w.getMonth(),1),new Date(w.getFullYear(),w.getMonth()+1,0)),l=[...a,...i];C(l);let n=Array.isArray(t.availability)?t.availability:t.availability?[t.availability]:[];R(n),k(U(l,D))})(),ei(!1)}catch(e){console.error("Error clearing availability:",e)}},ex=e=>{Z(e),X(!0)},eS=async e=>{if(b){ec(e),eu("accept");try{let t=await (0,L.U)({gigId:e,userId:b});if(t.error)throw Error(t.error);ev(t=>t.filter(t=>t.id!==e));let a=ey.find(t=>t.id===e);if(a){let e={...a,status:"ACCEPTED"};eh(t=>[...t,e])}}catch(e){console.error("Error accepting offer:",e)}finally{ec(null),eu(null)}}},eA=async e=>{if(b){ec(e),eu("decline");try{ev(t=>t.filter(t=>t.id!==e)),(0,Y.Z)({gigId:e,userId:b,role:"worker",action:"cancel"})}catch(e){console.error("Error declining offer:",e)}finally{ec(null),eu(null)}}};return(0,i.jsxs)("div",{className:F().container,children:[(0,i.jsx)(P.A,{onBackClick:()=>t.back()}),(0,i.jsx)(o.A,{date:w,view:g,role:"worker",onViewChange:e=>{_(e)},onNavigate:e=>{let t=new Date(w);"TODAY"===e?p(new Date):"PREV"===e?("day"===g&&t.setDate(t.getDate()-1),"week"===g&&t.setDate(t.getDate()-7),"month"===g&&t.setMonth(t.getMonth()-1),p(t)):"NEXT"===e&&("day"===g&&t.setDate(t.getDate()+1),"week"===g&&t.setDate(t.getDate()+7),"month"===g&&t.setMonth(t.getMonth()+1),p(t))},filters:G,activeFilter:D,onFilterChange:e=>{H(!0),setTimeout(()=>{x(e),k(U(j,e)),H(!1)},150)},onDateSelect:"Manage availability"===D?e=>ep(e):void 0}),(0,i.jsx)("main",{className:"".concat(F().mainContent," ").concat(V?F().filterTransitioning:""),children:"Manage availability"===D?(0,i.jsxs)(i.Fragment,{children:["day"===g&&(0,i.jsx)(W,{events:A,availabilitySlots:q,currentDate:w,onEventClick:em,onDateSelect:ep,onAvailabilityEdit:ex,onAvailabilityDelete:eg,onClearAll:()=>ei(!0),selectedDate:w}),"week"===g&&(0,i.jsx)(B,{events:A,availabilitySlots:q,currentDate:w,onEventClick:em,onDateSelect:ep,onAvailabilityEdit:ex,onAvailabilityDelete:eg,onClearAll:()=>ei(!0)}),"month"===g&&(0,i.jsx)(O,{events:A,availabilitySlots:q,currentDate:w,onEventClick:em,onDateSelect:ep,onAvailabilityEdit:ex,onAvailabilityDelete:eg,onClearAll:()=>ei(!0),selectedDate:w})]}):(0,i.jsx)(r.A,{date:w,events:A,view:g,onView:_,onNavigate:p,onSelectEvent:em,onSelectSlot:ep,userRole:"worker",activeFilter:D,components:{event:e=>(0,i.jsx)(s.A,{...e,userRole:"worker",view:g,activeFilter:D})},hideToolbar:!0})}),(0,i.jsx)(c.A,{event:M,isOpen:I,onClose:()=>{E(!1),T(null)},userRole:"worker",onAccept:()=>M&&M.id&&eS(M.id),onDecline:()=>M&&M.id&&eA(M.id),isProcessingAccept:null!=M&&es===M.id&&"accept"===ed,isProcessingDecline:null!=M&&es===M.id&&"decline"===ed}),(0,i.jsx)(S,{isOpen:Q,onClose:e_,slot:J,onSave:eb,onDelete:eg,selectedDate:K||void 0,selectedTime:ee||void 0,isEditingSingleOccurrence:el}),(0,i.jsx)(N,{isOpen:ea,onClose:()=>ei(!1),onConfirm:eD}),er&&J&&K&&(0,i.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},onClick:ew,children:(0,i.jsxs)("div",{style:{backgroundColor:"#232323",borderRadius:"12px",padding:"20px",maxWidth:"400px",width:"90%",color:"#fff"},onClick:e=>e.stopPropagation(),children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[(0,i.jsx)("h3",{style:{margin:0},children:"Edit Availability"}),(0,i.jsx)("button",{style:{background:"none",border:"none",color:"#fff",cursor:"pointer",fontSize:"20px"},onClick:ew,children:"\xd7"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{style:{marginBottom:"20px"},children:"This is a recurring availability pattern. What would you like to edit?"}),(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:[(0,i.jsx)("button",{style:{background:"#41a1e8",border:"none",borderRadius:"8px",padding:"12px 16px",color:"#fff",cursor:"pointer",fontWeight:"600"},onClick:()=>{en(!1),eo(!1),X(!0)},children:"Edit recurring pattern"}),(0,i.jsx)("button",{style:{background:"#7eeef9",border:"none",borderRadius:"8px",padding:"12px 16px",color:"#000",cursor:"pointer",fontWeight:"600"},onClick:()=>{en(!0),eo(!1),X(!0)},children:"Edit just this occurrence"})]})]})]})})]})}},10528:e=>{e.exports={overlay:"NewAvailabilityModal_overlay__vu73L",modal:"NewAvailabilityModal_modal__hL1c9",header:"NewAvailabilityModal_header__1WDIT",title:"NewAvailabilityModal_title__teE0v",closeButton:"NewAvailabilityModal_closeButton__CDuQT",content:"NewAvailabilityModal_content__RxXmP",formGroup:"NewAvailabilityModal_formGroup__u28_Q",label:"NewAvailabilityModal_label__rydgJ",timeInput:"NewAvailabilityModal_timeInput__uDbKR",recurrenceRow:"NewAvailabilityModal_recurrenceRow__3rGnd",recurrenceText:"NewAvailabilityModal_recurrenceText__U_erY",arrow:"NewAvailabilityModal_arrow__SkmNz",actions:"NewAvailabilityModal_actions__BpfFo",cancelButton:"NewAvailabilityModal_cancelButton__3G8m7",saveButton:"NewAvailabilityModal_saveButton__jTWzY",deleteButton:"NewAvailabilityModal_deleteButton__CZMC2",repeatSheet:"NewAvailabilityModal_repeatSheet__IBX13",repeatHeader:"NewAvailabilityModal_repeatHeader__cA7pU",repeatContent:"NewAvailabilityModal_repeatContent__IuDso",daysSection:"NewAvailabilityModal_daysSection__LWXGa",singleDateSection:"NewAvailabilityModal_singleDateSection__bcNJM",frequencySection:"NewAvailabilityModal_frequencySection__53L57",endsSection:"NewAvailabilityModal_endsSection__a3iyL",sectionLabel:"NewAvailabilityModal_sectionLabel__kBrrc",dateInput:"NewAvailabilityModal_dateInput__WAueH",datePicker:"NewAvailabilityModal_datePicker__jYG_i",daysGrid:"NewAvailabilityModal_daysGrid__wQg6_",dayButton:"NewAvailabilityModal_dayButton__yUIA_",dayButtonSelected:"NewAvailabilityModal_dayButtonSelected__YQPi7",frequencyInput:"NewAvailabilityModal_frequencyInput__TuvfW",endsInput:"NewAvailabilityModal_endsInput__PI1Hz",repeatActions:"NewAvailabilityModal_repeatActions__O3D4q",optionModal:"NewAvailabilityModal_optionModal__no0EK",optionHeader:"NewAvailabilityModal_optionHeader__OwQzU",optionContent:"NewAvailabilityModal_optionContent__icjOb",optionButton:"NewAvailabilityModal_optionButton__tGjeY",optionSelected:"NewAvailabilityModal_optionSelected__YRUWN",radioButton:"NewAvailabilityModal_radioButton__ya0yf",radioSelected:"NewAvailabilityModal_radioSelected__ec0AQ",optionActions:"NewAvailabilityModal_optionActions__DqOHz",confirmButton:"NewAvailabilityModal_confirmButton__YCqa_",dateInputContainer:"NewAvailabilityModal_dateInputContainer__p0uDp",occurrencesInputContainer:"NewAvailabilityModal_occurrencesInputContainer__vp2E0",occurrencesInput:"NewAvailabilityModal_occurrencesInput__z7Fy_",occurrencesLabel:"NewAvailabilityModal_occurrencesLabel__lb2fY"}},26977:e=>{e.exports={overlay:"ClearAvailabilityAlert_overlay__atoUO",alertDialog:"ClearAvailabilityAlert_alertDialog__n_FJG",alertHeader:"ClearAvailabilityAlert_alertHeader__wREio",alertContent:"ClearAvailabilityAlert_alertContent__0WKZY",alertActions:"ClearAvailabilityAlert_alertActions__JE7rA",cancelButton:"ClearAvailabilityAlert_cancelButton__uno4W",clearButton:"ClearAvailabilityAlert_clearButton__SfZe2"}},30100:e=>{e.exports={container:"DailyAvailabilityView_container__hcS1z",calendarFadeIn:"DailyAvailabilityView_calendarFadeIn___kvuo",header:"DailyAvailabilityView_header__T73At",headerSlideDown:"DailyAvailabilityView_headerSlideDown__5r0in",timeHeader:"DailyAvailabilityView_timeHeader__5ozL9",dayHeader:"DailyAvailabilityView_dayHeader__MNXg1",dayName:"DailyAvailabilityView_dayName__GAcRA",dayNumber:"DailyAvailabilityView_dayNumber__6j9eY",timeGrid:"DailyAvailabilityView_timeGrid__AqRdH",timeColumn:"DailyAvailabilityView_timeColumn__yWaau",timeLabel:"DailyAvailabilityView_timeLabel__Hsb3r",availabilityColumn:"DailyAvailabilityView_availabilityColumn__9C4Mf",emptySlot:"DailyAvailabilityView_emptySlot__33XJ1",availabilityBlock:"DailyAvailabilityView_availabilityBlock__YfYxv",availabilityContent:"DailyAvailabilityView_availabilityContent__EJDAV",availabilityTime:"DailyAvailabilityView_availabilityTime__9H0_P",availabilityStatus:"DailyAvailabilityView_availabilityStatus__fYhjP",contextMenu:"DailyAvailabilityView_contextMenu__ylZbg",deleteOption:"DailyAvailabilityView_deleteOption__17psr",clearButton:"DailyAvailabilityView_clearButton__a8DO4"}},34900:e=>{e.exports={weekViewContainer:"WeeklyAvailabilityView_weekViewContainer__2u5o0",header:"WeeklyAvailabilityView_header__ii73x",timeColumn:"WeeklyAvailabilityView_timeColumn__Cm9Lu",dayHeader:"WeeklyAvailabilityView_dayHeader__kStxY",dayName:"WeeklyAvailabilityView_dayName__P_phm",dayNumber:"WeeklyAvailabilityView_dayNumber__kyuNf",timeGrid:"WeeklyAvailabilityView_timeGrid__jP3DV",timeRow:"WeeklyAvailabilityView_timeRow__HIk_a",timeLabel:"WeeklyAvailabilityView_timeLabel__xuJjQ",timeSlot:"WeeklyAvailabilityView_timeSlot__rX3O9",availabilityBlock:"WeeklyAvailabilityView_availabilityBlock__chHAv",contextMenu:"WeeklyAvailabilityView_contextMenu__LUuUY",deleteOption:"WeeklyAvailabilityView_deleteOption__7PwxI",clearButton:"WeeklyAvailabilityView_clearButton__N9ukx"}},43866:e=>{e.exports={container:"WorkerCalendarPage_container__wFY2F",header:"WorkerCalendarPage_header__SrcYt",headerTop:"WorkerCalendarPage_headerTop__L9yDr",menuButton:"WorkerCalendarPage_menuButton__u6aiu",headerBottom:"WorkerCalendarPage_headerBottom__ZNxIq",filterPills:"WorkerCalendarPage_filterPills__2p2DR",filterPill:"WorkerCalendarPage_filterPill__iayln",activePill:"WorkerCalendarPage_activePill__IdHZi",mainContent:"WorkerCalendarPage_mainContent__xMM7m",filterTransitioning:"WorkerCalendarPage_filterTransitioning__qTnVo",footer:"WorkerCalendarPage_footer__MDaQO",homeButton:"WorkerCalendarPage_homeButton__awPbJ",dashboardButton:"WorkerCalendarPage_dashboardButton__L0rw_",clearButton:"WorkerCalendarPage_clearButton__GoZpn"}},46083:(e,t,a)=>{"use strict";a.d(t,{Z:()=>l});var i=a(34477);let l=(0,i.createServerReference)("406285e4a5b3e01ac696468e89531313be16ecb429",i.callServer,void 0,i.findSourceMapURL,"updateGigOfferStatus")},51178:(e,t,a)=>{"use strict";a.d(t,{g:()=>l});var i=a(34477);let l=(0,i.createServerReference)("40a6088411db4989a2f014a668b13745b3cfee1afe",i.callServer,void 0,i.findSourceMapURL,"getWorkerOffers")},69404:(e,t,a)=>{"use strict";a.d(t,{U:()=>l});var i=a(34477);let l=(0,i.createServerReference)("402e2448f83fdc0f1b31fdff1de0016567c7fd3feb",i.callServer,void 0,i.findSourceMapURL,"acceptGigOffer")},86332:e=>{e.exports={container:"MonthlyAvailabilityView_container__fxzlL",header:"MonthlyAvailabilityView_header__u_46e",monthInfo:"MonthlyAvailabilityView_monthInfo__P7eiY",monthTitle:"MonthlyAvailabilityView_monthTitle__8jGuX",chooseDateButton:"MonthlyAvailabilityView_chooseDateButton__5A8qq",calendarGrid:"MonthlyAvailabilityView_calendarGrid__OUVvr",dayHeaders:"MonthlyAvailabilityView_dayHeaders__sniM2",dayHeader:"MonthlyAvailabilityView_dayHeader__GfXoF",daysGrid:"MonthlyAvailabilityView_daysGrid__mglLp",dayCell:"MonthlyAvailabilityView_dayCell__fenqs",otherMonth:"MonthlyAvailabilityView_otherMonth__IECwJ",today:"MonthlyAvailabilityView_today___PkFx",selected:"MonthlyAvailabilityView_selected__jZCXi",hasAvailability:"MonthlyAvailabilityView_hasAvailability__8OQJ1",dayNumber:"MonthlyAvailabilityView_dayNumber__Bp2S2",availabilityIndicator:"MonthlyAvailabilityView_availabilityIndicator__fCHt9",navigation:"MonthlyAvailabilityView_navigation__54i0W",navButton:"MonthlyAvailabilityView_navButton__qSAR2",clearButton:"MonthlyAvailabilityView_clearButton__4Oc_T"}}},e=>{var t=t=>e(e.s=t);e.O(0,[5348,7685,2006,3151,2992,5965,586,9586,94,3063,6874,4086,5243,2170,8441,1684,7358],()=>t(5781)),_N_E=e.O()}]);