(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2808],{11470:(e,a,t)=>{Promise.resolve().then(t.bind(t,39865))},17576:(e,a,t)=>{"use strict";t.d(a,{A:()=>n});let n=(0,t(19946).A)("briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]])},19946:(e,a,t)=>{"use strict";t.d(a,{A:()=>d});var n=t(12115);let r=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),i=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,a,t)=>t?t.toUpperCase():a.toLowerCase()),s=e=>{let a=i(e);return a.charAt(0).toUpperCase()+a.slice(1)},l=function(){for(var e=arguments.length,a=Array(e),t=0;t<e;t++)a[t]=arguments[t];return a.filter((e,a,t)=>!!e&&""!==e.trim()&&t.indexOf(e)===a).join(" ").trim()},o=e=>{for(let a in e)if(a.startsWith("aria-")||"role"===a||"title"===a)return!0};var c={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let g=(0,n.forwardRef)((e,a)=>{let{color:t="currentColor",size:r=24,strokeWidth:i=2,absoluteStrokeWidth:s,className:g="",children:d,iconNode:u,...m}=e;return(0,n.createElement)("svg",{ref:a,...c,width:r,height:r,stroke:t,strokeWidth:s?24*Number(i)/Number(r):i,className:l("lucide",g),...!d&&!o(m)&&{"aria-hidden":"true"},...m},[...u.map(e=>{let[a,t]=e;return(0,n.createElement)(a,t)}),...Array.isArray(d)?d:[d]])}),d=(e,a)=>{let t=(0,n.forwardRef)((t,i)=>{let{className:o,...c}=t;return(0,n.createElement)(g,{ref:i,iconNode:a,className:l("lucide-".concat(r(s(e))),"lucide-".concat(e),o),...c})});return t.displayName=s(e),t}},25731:(e,a,t)=>{"use strict";t.d(a,{A:()=>g,O:()=>c});var n=t(95155),r=t(12115),i=t(16203),s=t(85004);let l=(0,r.createContext)({user:null,loading:!0});async function o(e){for(let t=0;t<10;t++){var a;let t=await (0,i.yx)(e,!0);if(null==(a=t.claims)?void 0:a.role)return t;await new Promise(e=>setTimeout(e,1e3))}return null}let c=e=>{let{children:a}=e,[t,c]=(0,r.useState)(null),[g,d]=(0,r.useState)(!0),{authClient:u,loading:m}=(0,s.D)();return(0,r.useEffect)(()=>{let e=()=>{};return!m&&u&&(e=(0,i.hg)(u,async e=>{if(e){let a=await o(e);a?c(Object.assign(e,{token:a.token,claims:a.claims})):c(null)}else c(null);d(!1)})),()=>e()},[m]),(0,n.jsx)(l.Provider,{value:{user:t,loading:g},children:a})},g=()=>(0,r.useContext)(l)},35169:(e,a,t)=>{"use strict";t.d(a,{A:()=>n});let n=(0,t(19946).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},35695:(e,a,t)=>{"use strict";var n=t(18999);t.o(n,"useParams")&&t.d(a,{useParams:function(){return n.useParams}}),t.o(n,"usePathname")&&t.d(a,{usePathname:function(){return n.usePathname}}),t.o(n,"useRouter")&&t.d(a,{useRouter:function(){return n.useRouter}}),t.o(n,"useSearchParams")&&t.d(a,{useSearchParams:function(){return n.useSearchParams}})},37873:(e,a,t)=>{"use strict";t.d(a,{A:()=>n});let n=(0,t(19946).A)("wine",[["path",{d:"M8 22h8",key:"rmew8v"}],["path",{d:"M7 10h10",key:"1101jm"}],["path",{d:"M12 15v7",key:"t2xh3l"}],["path",{d:"M12 15a5 5 0 0 0 5-5c0-2-.5-4-2-8H9c-1.5 4-2 6-2 8a5 5 0 0 0 5 5Z",key:"10ffi3"}]])},39865:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>y});var n=t(95155),r=t(12115),i=t(35695),s=t(37873),l=t(95747),o=t(17576),c=t(51154),g=t(35169),d=t(66932),u=t(91106),m=t.n(u),_=t(25731),h=t(86325);async function p(e,a){console.log("Fetching earnings for workerId:",e,"with filter:",a),await new Promise(e=>setTimeout(e,700));let t=[{id:"e1",gigType:"Bartender",gigTitle:"Weekend Bar Shift",buyerName:"The Grand Cafe",date:"2023-12-15T00:00:00Z",amount:150,status:"Cleared",gigId:"gig101"},{id:"e2",gigType:"Waiter",gigTitle:"Private Dinner Party",buyerName:"Alice Wonderland",date:"2023-12-11T00:00:00Z",amount:120,status:"Cleared",gigId:"gig102"},{id:"e3",gigType:"Bartender",gigTitle:"Corporate Event Cocktails",buyerName:"Innovate Corp",date:"2023-12-09T00:00:00Z",amount:180,status:"Pending",gigId:"gig103"},{id:"e4",gigType:"Chef",gigTitle:"Pop-up Kitchen Lead",buyerName:"Foodie Fest",date:"2023-11-22T00:00:00Z",amount:230,status:"Cleared",gigId:"gig104"}];return a&&"All"!==a?t.filter(e=>e.gigType===a):t.sort((e,a)=>new Date(a.date).getTime()-new Date(e.date).getTime())}let f=e=>{let a={};return e.forEach(e=>{if("Cleared"===e.status){let t=new Date(e.date).toLocaleString("default",{month:"short",year:"2-digit"});a[t]=(a[t]||0)+e.amount}}),Object.entries(a).map(e=>{let[a,t]=e;return{name:a,total:t}}).reverse()};function y(){let e=(0,i.useRouter)(),a=(0,i.useParams)().userId,t=(0,h.K)(),{user:u,loading:y}=(0,_.A)(),v=null==u?void 0:u.uid,[x,E]=(0,r.useState)([]),[P,N]=(0,r.useState)(!0),[C,A]=(0,r.useState)(null),[j,k]=(0,r.useState)("All"),[w,b]=(0,r.useState)(!1);(0,r.useEffect)(()=>{!y&&u&&v===a&&((null==u?void 0:u.claims.role)==="GIG_WORKER"||(null==u?void 0:u.claims.role)==="QA")?(N(!0),p(a,j).then(e=>{E(e),A(null)}).catch(e=>{console.error("Failed to fetch earnings:",e),A("Failed to load earnings. Please try again."),E([])}).finally(()=>N(!1))):!y&&u&&v===a&&"GIG_WORKER"!==t&&(null==u?void 0:u.claims.role)!=="QA"?(N(!1),E([]),A("Access denied: You do not have the required role to view earnings.")):y||u&&v===a||(N(!1),E([]))},[u,y,v,a,j]),(0,r.useMemo)(()=>f(x),[x]);let S=e=>"Bartender"===e?(0,n.jsx)(s.A,{size:18,className:m().earningGigIcon}):"Waiter"===e||"Chef"===e?(0,n.jsx)(l.A,{size:18,className:m().earningGigIcon}):(0,n.jsx)(o.A,{size:18,className:m().earningGigIcon});return y||!u?(0,n.jsxs)("div",{className:m().loadingContainer,children:[(0,n.jsx)(c.A,{className:"animate-spin",size:32})," Loading..."]}):(0,n.jsx)("div",{className:m().container,children:(0,n.jsxs)("div",{className:m().pageWrapper,children:[(0,n.jsxs)("header",{className:m().header,children:[(0,n.jsx)("button",{onClick:()=>e.back(),className:m().backButton,children:(0,n.jsx)(g.A,{size:16})}),(0,n.jsx)("h1",{className:m().pageTitle,children:"Earnings"}),(0,n.jsxs)("button",{onClick:()=>b(!0),className:m().filterButton,children:[(0,n.jsx)(d.A,{size:16})," Filter"]})]}),w&&(0,n.jsx)("div",{className:m().modalOverlay,onClick:()=>b(!1),children:(0,n.jsxs)("div",{className:m().modalContent,onClick:e=>e.stopPropagation(),children:[(0,n.jsx)("h3",{className:m().modalHeader,children:"Filter Earnings"}),(0,n.jsx)("div",{className:m().filterOptions,style:{flexDirection:"column"},children:["All","Bartender","Waiter","Chef","Event Staff"].map(e=>(0,n.jsxs)("label",{className:m().filterOptionLabel,style:{padding:"0.5rem 0"},children:[(0,n.jsx)("input",{type:"radio",name:"gigTypeModalEarningsFilter",value:e,checked:j===e,onChange:()=>{k(e),b(!1)}}),e]},e))}),(0,n.jsx)("div",{className:m().modalActions,children:(0,n.jsx)("button",{onClick:()=>b(!1),className:"".concat(m().actionButton," ").concat(m().secondary),children:"Close"})})]})}),P?(0,n.jsxs)("div",{className:m().loadingContainer,children:[(0,n.jsx)(c.A,{className:"animate-spin",size:28})," Loading earnings..."]}):C?(0,n.jsx)("div",{className:m().emptyState,children:C}):0===x.length?(0,n.jsxs)("div",{className:m().emptyState,children:["No earnings history found ","All"!==j?"for ".concat(j,"s"):"","."]}):(0,n.jsx)("div",{className:m().earningsList,children:x.map(e=>(0,n.jsxs)("div",{className:m().earningItem,children:[(0,n.jsxs)("div",{className:m().earningDetails,children:[S(e.gigType),(0,n.jsxs)("div",{className:m().earningHeader,children:[(0,n.jsx)("span",{className:m().earningGigInfo,children:e.gigType}),(0,n.jsx)("span",{className:m().earningDate,children:new Date(e.date).toLocaleDateString()})]})]}),(0,n.jsxs)("span",{className:m().amount,children:["\xa3",e.amount.toFixed(2)]})]},e.id))})]})})}},51154:(e,a,t)=>{"use strict";t.d(a,{A:()=>n});let n=(0,t(19946).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},66932:(e,a,t)=>{"use strict";t.d(a,{A:()=>n});let n=(0,t(19946).A)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]])},85004:(e,a,t)=>{"use strict";t.d(a,{D:()=>m,R:()=>u});var n=t(95155),r=t(12115),i=t(23915),s=t(16203),l=t(35317),o=t(90858),c=t(74826),g=t(20996);let d=(0,r.createContext)(null),u=e=>{let{children:a}=e,[t,u]=r.useState(null),[m,_]=r.useState(null),[h,p]=r.useState(null),[f,y]=r.useState(null),[v,x]=r.useState(null),[E,P]=r.useState(!0);return(0,r.useEffect)(()=>{!async function(){let e,a=await fetch("/firebase-config.json"),t=await a.json();0===(0,i.Dk)().length?(console.log("[Firebase] Initializing new instance..."),e=(0,i.Wp)(t)):(console.log("[Firebase] Reusing existing instance."),e=(0,i.Sx)()),u((0,s.xI)(e)),p((0,l.aU)(e)),y((0,o.c7)(e)),x((0,c.lS)(e,{backend:new c.C8})),_((0,g.dG)(e)),P(!1)}()},[]),(0,n.jsx)(d.Provider,{value:{authClient:t,db:h,storage:f,ai:v,messaging:m,loading:E},children:a})},m=()=>{let e=(0,r.useContext)(d);if(!e)throw Error("useFirebase must be used within FirebaseProvider");return e}},86325:(e,a,t)=>{"use strict";async function n(e){try{return localStorage.setItem("lastRoleUsed",e),null}catch(e){console.log("Error updating last role used:",e)}}function r(){try{return window.localStorage.getItem("lastRoleUsed")}catch(e){return console.log("Error retrieving last role used:",e),null}}t.d(a,{C:()=>n,K:()=>r})},91106:e=>{e.exports={container:"EarningsPage_container__2d2fX",pageWrapper:"EarningsPage_pageWrapper__cmDtf",header:"EarningsPage_header__cKV_R",backButton:"EarningsPage_backButton__JyBaV",pageTitle:"EarningsPage_pageTitle__N1Aqy",filterButton:"EarningsPage_filterButton__ou_DG",filterSection:"EarningsPage_filterSection__F3kt7",filterSectionTitle:"EarningsPage_filterSectionTitle__HTEku",filterOptions:"EarningsPage_filterOptions__xmVFx",filterOptionLabel:"EarningsPage_filterOptionLabel__8RcQc",earningsList:"EarningsPage_earningsList__gDaWJ",earningItem:"EarningsPage_earningItem__VNEmm",earningDetails:"EarningsPage_earningDetails__U2a6N",earningHeader:"EarningsPage_earningHeader__LDcn_",earningGigIcon:"EarningsPage_earningGigIcon__HFagE",earningGigInfo:"EarningsPage_earningGigInfo__amnq6",earningDate:"EarningsPage_earningDate__LvUxY",earningBuyerName:"EarningsPage_earningBuyerName__Zi6c2",amount:"EarningsPage_amount__YAxuE",actions:"EarningsPage_actions__9iFZf",actionButton:"EarningsPage_actionButton__EXo4q",barChartContainer:"EarningsPage_barChartContainer__KfLgD",emptyState:"EarningsPage_emptyState__eCxS_",loadingContainer:"EarningsPage_loadingContainer__HC_g5",modalOverlay:"EarningsPage_modalOverlay__9WPaT",modalContent:"EarningsPage_modalContent__por3u",modalHeader:"EarningsPage_modalHeader__qQdF2",modalActions:"EarningsPage_modalActions__MfO_t",secondary:"EarningsPage_secondary__dwX2N",chartTooltip:"EarningsPage_chartTooltip__cOg_m",tooltipLabel:"EarningsPage_tooltipLabel__qBoEK",tooltipValue:"EarningsPage_tooltipValue__3RdAB"}},95747:(e,a,t)=>{"use strict";t.d(a,{A:()=>n});let n=(0,t(19946).A)("utensils",[["path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2",key:"cjf0a3"}],["path",{d:"M7 2v20",key:"1473qp"}],["path",{d:"M21 15V2a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7",key:"j28e5"}]])}},e=>{var a=a=>e(e.s=a);e.O(0,[6329,2992,5965,94,8441,1684,7358],()=>a(11470)),_N_E=e.O()}]);