(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6515],{87:(e,t,a)=>{Promise.resolve().then(a.bind(a,82200))},6654:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"useMergedRef",{enumerable:!0,get:function(){return s}});let n=a(12115);function s(e,t){let a=(0,n.useRef)(null),s=(0,n.useRef)(null);return(0,n.useCallback)(n=>{if(null===n){let e=a.current;e&&(a.current=null,e());let t=s.current;t&&(s.current=null,t())}else e&&(a.current=i(e,n)),t&&(s.current=i(t,n))},[e,t])}function i(e,t){if("function"!=typeof e)return e.current=t,()=>{e.current=null};{let a=e(t);return"function"==typeof a?a:()=>e(null)}}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},17576:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});let n=(0,a(19946).A)("briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]])},19946:(e,t,a)=>{"use strict";a.d(t,{A:()=>d});var n=a(12115);let s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),i=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,a)=>a?a.toUpperCase():t.toLowerCase()),r=e=>{let t=i(e);return t.charAt(0).toUpperCase()+t.slice(1)},l=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim()},o=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var c={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let u=(0,n.forwardRef)((e,t)=>{let{color:a="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:r,className:u="",children:d,iconNode:m,...g}=e;return(0,n.createElement)("svg",{ref:t,...c,width:s,height:s,stroke:a,strokeWidth:r?24*Number(i)/Number(s):i,className:l("lucide",u),...!d&&!o(g)&&{"aria-hidden":"true"},...g},[...m.map(e=>{let[t,a]=e;return(0,n.createElement)(t,a)}),...Array.isArray(d)?d:[d]])}),d=(e,t)=>{let a=(0,n.forwardRef)((a,i)=>{let{className:o,...c}=a;return(0,n.createElement)(u,{ref:i,iconNode:t,className:l("lucide-".concat(s(r(e))),"lucide-".concat(e),o),...c})});return a.displayName=r(e),a}},25731:(e,t,a)=>{"use strict";a.d(t,{A:()=>u,O:()=>c});var n=a(95155),s=a(12115),i=a(16203),r=a(85004);let l=(0,s.createContext)({user:null,loading:!0});async function o(e){for(let a=0;a<10;a++){var t;let a=await (0,i.yx)(e,!0);if(null==(t=a.claims)?void 0:t.role)return a;await new Promise(e=>setTimeout(e,1e3))}return null}let c=e=>{let{children:t}=e,[a,c]=(0,s.useState)(null),[u,d]=(0,s.useState)(!0),{authClient:m,loading:g}=(0,r.D)();return(0,s.useEffect)(()=>{let e=()=>{};return!g&&m&&(e=(0,i.hg)(m,async e=>{if(e){let t=await o(e);t?c(Object.assign(e,{token:t.token,claims:t.claims})):c(null)}else c(null);d(!1)})),()=>e()},[g]),(0,n.jsx)(l.Provider,{value:{user:a,loading:u},children:t})},u=()=>(0,s.useContext)(l)},29261:e=>{e.exports={container:"PaymentsPage_container__l4piu",pageWrapper:"PaymentsPage_pageWrapper__FpaZj",header:"PaymentsPage_header__XOzqv",backButton:"PaymentsPage_backButton__gP_n2",totalsNote:"PaymentsPage_totalsNote__KhYlA",pageTitle:"PaymentsPage_pageTitle__e4BNt",filterButton:"PaymentsPage_filterButton__wiWin",filterSection:"PaymentsPage_filterSection__1Hfxl",filterSectionTitle:"PaymentsPage_filterSectionTitle__cvkHv",filterOptions:"PaymentsPage_filterOptions__ZyYRn",filterOptionLabel:"PaymentsPage_filterOptionLabel__I4zLg",filterNote:"PaymentsPage_filterNote__EQRb0",paymentList:"PaymentsPage_paymentList__lGmC8",paymentRight:"PaymentsPage_paymentRight__V9LJo",amount:"PaymentsPage_amount__0HQIs",actions:"PaymentsPage_actions__UBJUa",actionButton:"PaymentsPage_actionButton__Oe60d",barChartContainer:"PaymentsPage_barChartContainer__2iMOh",emptyState:"PaymentsPage_emptyState__slFFz",loadingContainer:"PaymentsPage_loadingContainer___bIm_",modalOverlay:"PaymentsPage_modalOverlay__is0UU",modalContent:"PaymentsPage_modalContent__4unIE",modalHeader:"PaymentsPage_modalHeader__Qv14l",modalActions:"PaymentsPage_modalActions__kaTtx",chartTooltip:"PaymentsPage_chartTooltip__RXrs4",tooltipLabel:"PaymentsPage_tooltipLabel__wWu6p",tooltipValue:"PaymentsPage_tooltipValue__aIzpo",paymentItem:"PaymentsPage_paymentItem__epoC_",paymentGigIcon:"PaymentsPage_paymentGigIcon__zIVEQ",paymentCard:"PaymentsPage_paymentCard___3WVp",paymentDetails:"PaymentsPage_paymentDetails___BIQf",paymentHeader:"PaymentsPage_paymentHeader__2vQyT",generateInvoice:"PaymentsPage_generateInvoice__RhuCV"}},35169:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});let n=(0,a(19946).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},35695:(e,t,a)=>{"use strict";var n=a(18999);a.o(n,"useParams")&&a.d(t,{useParams:function(){return n.useParams}}),a.o(n,"usePathname")&&a.d(t,{usePathname:function(){return n.usePathname}}),a.o(n,"useRouter")&&a.d(t,{useRouter:function(){return n.useRouter}}),a.o(n,"useSearchParams")&&a.d(t,{useSearchParams:function(){return n.useSearchParams}})},37873:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});let n=(0,a(19946).A)("wine",[["path",{d:"M8 22h8",key:"rmew8v"}],["path",{d:"M7 10h10",key:"1101jm"}],["path",{d:"M12 15v7",key:"t2xh3l"}],["path",{d:"M12 15a5 5 0 0 0 5-5c0-2-.5-4-2-8H9c-1.5 4-2 6-2 8a5 5 0 0 0 5 5Z",key:"10ffi3"}]])},51154:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});let n=(0,a(19946).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},57434:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});let n=(0,a(19946).A)("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},66932:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});let n=(0,a(19946).A)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]])},82200:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>v});var n=a(95155),s=a(12115),i=a(35695),r=a(6874),l=a.n(r),o=a(37873),c=a(95747),u=a(17576),d=a(51154),m=a(35169),g=a(66932),p=a(57434),y=a(29261),h=a.n(y),_=a(25731);async function f(e,t){console.log("Fetching payments for buyerId:",e,"with filter:",t),await new Promise(e=>setTimeout(e,700));let a=[{id:"1",gigType:"Bartender",workerName:"Jerimaiah Jones",date:"2023-12-12T10:00:00Z",amount:165,status:"Paid",invoiceUrl:"invoices/inv-001.pdf",gigId:"gig1"},{id:"2",gigType:"Waiter",workerName:"Gavin Trysdale, B. Button",date:"2023-12-10T14:30:00Z",amount:420,status:"Paid",gigId:"gig2"},{id:"3",gigType:"Bartender",workerName:"Megan House",date:"2023-12-08T18:00:00Z",amount:180,status:"Paid",gigId:"gig3"},{id:"4",gigType:"Chef",workerName:"Gordon Ramsay Jr.",date:"2023-11-20T12:00:00Z",amount:250,status:"Paid",invoiceUrl:"invoices/inv-004.pdf",gigId:"gig4"},{id:"5",gigType:"Bartender",workerName:"Jerimaiah Jones",date:"2023-11-05T19:00:00Z",amount:150,status:"Paid",gigId:"gig5"}];return t&&"All"!==t?a.filter(e=>e.gigType===t):a.sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime())}let P=e=>{let t={};return e.forEach(e=>{if("Paid"===e.status){let a=new Date(e.date).toLocaleString("default",{month:"short",year:"2-digit"});t[a]=(t[a]||0)+e.amount}}),Object.entries(t).map(e=>{let[t,a]=e;return{name:t,total:a}}).reverse()};function v(){let e=(0,i.useRouter)(),t=(0,i.useParams)(),a=t.userId,{user:r,loading:y}=(0,_.A)(),v=null==r?void 0:r.uid,[x,j]=(0,s.useState)([]),[N,k]=(0,s.useState)(!0),[b,A]=(0,s.useState)(null),[C,w]=(0,s.useState)("All"),[I,S]=(0,s.useState)(!1);(0,s.useEffect)(()=>{k(!0),f(v||"",C).then(e=>{j(e),A(null)}).catch(e=>{console.error("Failed to fetch payments:",e),A("Could not load payment history. Please try again.")}).finally(()=>k(!1))},[y,r,v,a,C,e]);let T=t=>{if(!t)return void alert("Gig ID not available for rehire.");console.log("Repeat gig ID:",t),e.push("gigs/".concat(t,"/rehire"))};(0,s.useMemo)(()=>P(x),[x]);let M=e=>"Bartender"===e?(0,n.jsx)(o.A,{size:18,className:h().paymentGigIcon}):"Waiter"===e||"Chef"===e?(0,n.jsx)(c.A,{size:18,className:h().paymentGigIcon}):(0,n.jsx)(u.A,{size:18,className:h().paymentGigIcon});return y||!r&&!y||v&&v!==a?(0,n.jsxs)("div",{className:h().loadingContainer,children:[(0,n.jsx)(d.A,{className:"animate-spin",size:32})," Loading..."]}):(0,n.jsx)("div",{className:h().container,children:(0,n.jsxs)("div",{className:h().pageWrapper,children:[(0,n.jsxs)("header",{className:h().header,children:[(0,n.jsx)("button",{onClick:()=>e.back(),className:h().backButton,children:(0,n.jsx)(m.A,{size:16})}),(0,n.jsx)("h1",{className:h().pageTitle,children:"Payments"}),(0,n.jsxs)("button",{onClick:()=>S(!0),className:h().filterButton,children:[(0,n.jsx)(g.A,{size:16})," Filter"]})]}),(0,n.jsx)("p",{className:h().totalsNote,children:"Totals include Able AI & payment provider fees."}),I&&(0,n.jsx)("div",{className:h().modalOverlay,onClick:()=>S(!1),children:(0,n.jsxs)("div",{className:h().modalContent,onClick:e=>e.stopPropagation(),children:[(0,n.jsx)("h3",{className:h().modalHeader,children:"Filter Payments"}),(0,n.jsx)("div",{className:h().filterOptions,style:{flexDirection:"column"},children:["All","Bartender","Waiter","Chef","Event Staff"].map(e=>(0,n.jsxs)("label",{className:h().filterOptionLabel,style:{padding:"0.5rem 0"},children:[(0,n.jsx)("input",{type:"radio",name:"gigTypeModalFilter",value:e,checked:C===e,onChange:()=>{w(e),S(!1)}}),e]},e))}),(0,n.jsx)("div",{className:h().modalActions,children:(0,n.jsx)("button",{onClick:()=>S(!1),className:"".concat(h().actionButton," ").concat(h().secondary),children:"Close"})})]})}),N?(0,n.jsxs)("div",{className:h().loadingContainer,children:[(0,n.jsx)(d.A,{className:"animate-spin",size:28})," Loading payments..."]}):b?(0,n.jsx)("div",{className:h().emptyState,children:b}):0===x.length?(0,n.jsxs)("div",{className:h().emptyState,children:["No payment history found ","All"!==C?"for ".concat(C,"s"):"","."]}):(0,n.jsx)("div",{className:h().paymentList,children:x.map(e=>(0,n.jsxs)("div",{className:h().paymentItem,children:[(0,n.jsxs)("div",{className:h().paymentCard,children:[(0,n.jsxs)("div",{className:h().paymentDetails,children:[M(e.gigType),(0,n.jsxs)("div",{className:h().paymentHeader,children:[(0,n.jsxs)("span",{className:h().paymentGigInfo,children:[e.gigType,", ",e.workerName]}),(0,n.jsx)("span",{className:h().paymentDate,children:new Date(e.date).toLocaleDateString()})]})]}),"Paid"===e.status&&(0,n.jsxs)(l(),{href:"/user/".concat(t.userId,"/buyer/payments/invoice?id=").concat(e.id),className:h().generateInvoice,children:[(0,n.jsx)(p.A,{size:20})," Generate Invoice"]})]}),(0,n.jsxs)("div",{className:h().paymentRight,children:[(0,n.jsxs)("span",{className:h().amount,children:["\xa3",e.amount.toFixed(2)]}),(0,n.jsx)("div",{className:h().actions,children:(0,n.jsx)("button",{onClick:()=>T(e.gigId),className:h().actionButton,children:"Repeat Gig"})})]})]},e.id))})]})})}},85004:(e,t,a)=>{"use strict";a.d(t,{D:()=>g,R:()=>m});var n=a(95155),s=a(12115),i=a(23915),r=a(16203),l=a(35317),o=a(90858),c=a(74826),u=a(20996);let d=(0,s.createContext)(null),m=e=>{let{children:t}=e,[a,m]=s.useState(null),[g,p]=s.useState(null),[y,h]=s.useState(null),[_,f]=s.useState(null),[P,v]=s.useState(null),[x,j]=s.useState(!0);return(0,s.useEffect)(()=>{!async function(){let e,t=await fetch("/firebase-config.json"),a=await t.json();0===(0,i.Dk)().length?(console.log("[Firebase] Initializing new instance..."),e=(0,i.Wp)(a)):(console.log("[Firebase] Reusing existing instance."),e=(0,i.Sx)()),m((0,r.xI)(e)),h((0,l.aU)(e)),f((0,o.c7)(e)),v((0,c.lS)(e,{backend:new c.C8})),p((0,u.dG)(e)),j(!1)}()},[]),(0,n.jsx)(d.Provider,{value:{authClient:a,db:y,storage:_,ai:P,messaging:g,loading:x},children:t})},g=()=>{let e=(0,s.useContext)(d);if(!e)throw Error("useFirebase must be used within FirebaseProvider");return e}},95747:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});let n=(0,a(19946).A)("utensils",[["path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2",key:"cjf0a3"}],["path",{d:"M7 2v20",key:"1473qp"}],["path",{d:"M21 15V2a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7",key:"j28e5"}]])}},e=>{var t=t=>e(e.s=t);e.O(0,[3322,2992,5965,94,6874,8441,1684,7358],()=>t(87)),_N_E=e.O()}]);