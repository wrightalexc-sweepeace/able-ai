(()=>{var e={};e.id=6228,e.ids=[6228],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},7879:e=>{"use strict";e.exports=import("firebase-admin/firestore")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},12470:(e,t,r)=>{"use strict";r.d(t,{o:()=>n});var s=r(8835);let i=process.env.STRIPE_SECRET_KEY,n=i?new s.A(i):new Proxy({},{get(){throw Error("Stripe is not configured (missing STRIPE_SECRET_KEY). This action requires Stripe to be set up.")}})},14276:e=>{"use strict";e.exports=import("firebase-admin/auth")},14985:e=>{"use strict";e.exports=require("dns")},17242:(e,t,r)=>{Promise.resolve().then(r.bind(r,47521))},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},19771:e=>{"use strict";e.exports=require("process")},21820:e=>{"use strict";e.exports=require("os")},25380:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>a.a,__next_app__:()=>u,pages:()=>l,routeModule:()=>p,tree:()=>c});var s=r(65239),i=r(48088),n=r(88170),a=r.n(n),o=r(30893),d={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>o[e]);r.d(t,d);let c={children:["",{children:["(web-client)",{children:["user",{children:["[userId]",{children:["settings",{children:["onboarding-retry",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,39527)),"/home/israel/personal/code/alex/able-ai/app/(web-client)/user/[userId]/settings/onboarding-retry/page.tsx"]}]},{}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,14866)),"/home/israel/personal/code/alex/able-ai/app/(web-client)/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,46055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,58014)),"/home/israel/personal/code/alex/able-ai/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,46055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,l=["/home/israel/personal/code/alex/able-ai/app/(web-client)/user/[userId]/settings/onboarding-retry/page.tsx"],u={require:r,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:i.RouteKind.APP_PAGE,page:"/(web-client)/user/[userId]/settings/onboarding-retry/page",pathname:"/user/[userId]/settings/onboarding-retry",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},26532:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{I:()=>p});var i=r(91199);r(42087);var n=r(74208),a=r(18839),o=r(12470),d=r(30298),c=r(60444),l=r(33331),u=e([d]);async function p(e){let t=await (0,n.b3)(),r=t.get("origin")||t.get("host");try{if(!e)return{error:"User ID is required.",status:400};let t=await d.db.query.UsersTable.findFirst({where:(0,a.eq)(c.UsersTable.firebaseUid,e)});if(!t)throw Error("User not found");let s=t?.stripeConnectAccountId;return s||(s=(await o.o.accounts.create({type:"express",country:"US",email:t?.email||"",capabilities:{card_payments:{requested:!0},transfers:{requested:!0}},business_type:"individual",individual:{email:t?.email||"",first_name:t?.fullName?.split(" ")[0],last_name:t?.fullName?.slice(t.fullName.indexOf(" ")+1)},metadata:{userId:String(t?.id)}})).id,await d.db.update(c.UsersTable).set({stripeConnectAccountId:s}).where((0,a.eq)(c.UsersTable.id,t.id))),{url:(await o.o.accountLinks.create({account:s,refresh_url:`${r}/user/${t.id}/settings/onboarding-retry`,return_url:`${r}/user/${t.id}/settings/onboarding-success?account_id=${s}`,type:"account_onboarding"})).url,status:200}}catch(e){return console.error("Error creating Stripe Account Link:",e),{error:e.message,status:500}}}d=(u.then?(await u)():u)[0],(0,l.D)([p]),(0,i.A)(p,"404a83a773f709870df51d0df4fef9f92c356ea997",null),s()}catch(e){s(e)}})},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},30474:(e,t,r)=>{"use strict";r.d(t,{default:()=>i.a});var s=r(31261),i=r.n(s)},31261:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{default:function(){return d},getImageProps:function(){return o}});let s=r(37366),i=r(44953),n=r(46533),a=s._(r(1933));function o(e){let{props:t}=(0,i.getImgProps)(e,{defaultLoader:a.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,r]of Object.entries(t))void 0===r&&delete t[e];return{props:t}}let d=n.Image},32790:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{"400cd1fa767ef5281508e93e3ca1d7a0d11ad8371f":()=>i.qM,"404660310a5e0f58f816c762a9f12b9b33702d2493":()=>i.OH,"404a83a773f709870df51d0df4fef9f92c356ea997":()=>n.I,"40bcfd414a2446406921fe5bddeb7f04b82b554661":()=>i.Rz,"60976633aa90a3960f31dd64f4fd8496ccbdb52456":()=>i.a6,"60e7f34a33097c37a8e1219f48e58834e6fa037656":()=>i.r2,"7fad076ff87a53fb2dc1878d8dc87b650c1a1b2caa":()=>i.gL});var i=r(29034),n=r(26532),a=e([i,n]);[i,n]=a.then?(await a)():a,s()}catch(e){s(e)}})},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},35088:(e,t,r)=>{"use strict";r.d(t,{I:()=>i});var s=r(6475);let i=(0,s.createServerReference)("404a83a773f709870df51d0df4fef9f92c356ea997",s.callServer,void 0,s.findSourceMapURL,"createAccountLink")},39527:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/israel/personal/code/alex/able-ai/app/(web-client)/user/[userId]/settings/onboarding-retry/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/israel/personal/code/alex/able-ai/app/(web-client)/user/[userId]/settings/onboarding-retry/page.tsx","default")},46675:e=>{"use strict";e.exports=require("firebase-admin")},47521:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>p});var s=r(60687),i=r(35088),n=r(21295),a=r(16189),o=r(43210),d=r(69788),c=r.n(d),l=r(78149),u=r.n(l);function p(){let{user:e,loading:t}=(0,n.A)();(0,a.useRouter)(),(0,a.useParams)().userId;let[r,d]=(0,o.useState)(!1),[l,p]=(0,o.useState)(null),g=async()=>{if(!t&&e){d(!0),p(null);try{let t=await (0,i.I)(e?.uid);if(t.error&&500===t.status)throw Error(t.error||"Failed to generate a new Stripe account link.");200===t.status&&t.url&&(window.location.href=t.url)}catch(e){p(e.message||"An unexpected error occurred.")}finally{d(!1)}}};return(0,s.jsx)("div",{className:c().container,children:(0,s.jsxs)("div",{className:`${c().card} ${u().onboardCard}`,children:[(0,s.jsxs)("header",{className:c().pageHeader,children:[(0,s.jsx)("h1",{className:"pb-2",children:"Stripe Connection Failed or Expired"}),(0,s.jsx)("p",{children:"It looks like your Stripe account connection session expired or encountered an issue."}),(0,s.jsx)("p",{children:"Please try connecting your account again."})]}),(0,s.jsx)("div",{className:u().buttonWrapper,children:(0,s.jsx)("button",{type:"submit",disabled:r,className:c().button,onClick:g,children:r?"Retrying...":"Try Again"})}),l&&(0,s.jsxs)("p",{style:{color:"red"},children:["Error: ",l]}),(0,s.jsx)("p",{style:{marginTop:"auto"},children:"If the issue persists, please contact support."})]})})}},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},64939:e=>{"use strict";e.exports=import("pg")},69788:e=>{e.exports={container:"SettingsPage_container__x7Ugk",card:"SettingsPage_card__RPA5a",pageWrapper:"SettingsPage_pageWrapper__jAv2v",pageHeader:"SettingsPage_pageHeader__IPiGF",section:"SettingsPage_section__53RKH",sectionTitle:"SettingsPage_sectionTitle__neP96",form:"SettingsPage_form__sbwBS",formGroup:"SettingsPage_formGroup__6o89j",label:"SettingsPage_label__7ReZn",inputField:"SettingsPage_inputField__ywxTh",actionButtons:"SettingsPage_actionButtons__Wpvj0",button:"SettingsPage_button__UO4k9",secondary:"SettingsPage_secondary__ifHfj",danger:"SettingsPage_danger__6o6Pv",errorMessage:"SettingsPage_errorMessage__TbRSe",successMessage:"SettingsPage_successMessage__oEpcO",verificationSection:"SettingsPage_verificationSection__enDg_",verificationHeader:"SettingsPage_verificationHeader__BM_6D",warningIcon:"SettingsPage_warningIcon__lJrub",verificationModalTitle:"SettingsPage_verificationModalTitle__Go0QF",verificationText:"SettingsPage_verificationText__kQWg8",verificationActions:"SettingsPage_verificationActions__S_Z8e",resendButton:"SettingsPage_resendButton__F7p0K",modalOverlay:"SettingsPage_modalOverlay__3E3Hd",modalContent:"SettingsPage_modalContent__SxHiM",modalTitle:"SettingsPage_modalTitle__EqqS9",modalActions:"SettingsPage_modalActions__GOE9o",closeButton:"SettingsPage_closeButton__HJ688",modalHeader:"SettingsPage_modalHeader__IXvxa",bottomNavSection:"SettingsPage_bottomNavSection__Fvvyt",bottomNav:"SettingsPage_bottomNav__YBsS_",bottomNavLink:"SettingsPage_bottomNavLink__4aE_x",dangerLink:"SettingsPage_dangerLink__xIS_c",pageDescription:"SettingsPage_pageDescription__dhnvR",profileInfo:"SettingsPage_profileInfo__VGWTF",linkList:"SettingsPage_linkList__OkGOY",passwordChangeSection:"SettingsPage_passwordChangeSection__57gx8",loadingContainer:"SettingsPage_loadingContainer__3uwln",stripePromptInline:"SettingsPage_stripePromptInline__1xf3_",stripePromptHeader:"SettingsPage_stripePromptHeader___PeiB",stripeIconWrapper:"SettingsPage_stripeIconWrapper__HPLJp",stripeButton:"SettingsPage_stripeButton__9mpfO",stripeStatus:"SettingsPage_stripeStatus__q3LlT",stripeStatusBannerConnected:"SettingsPage_stripeStatusBannerConnected__2y3qb",settingItem:"SettingsPage_settingItem__qzFsE",settingLabel:"SettingsPage_settingLabel__cpvHX"}},70386:(e,t,r)=>{Promise.resolve().then(r.bind(r,39527))},73496:e=>{"use strict";e.exports=require("http2")},74075:e=>{"use strict";e.exports=require("zlib")},78149:e=>{e.exports={onboardCard:"onboarding-retry_onboardCard__gKL36",buttonWrapper:"onboarding-retry_buttonWrapper__ANRm1"}},79551:e=>{"use strict";e.exports=require("url")},79646:e=>{"use strict";e.exports=require("child_process")},81630:e=>{"use strict";e.exports=require("http")},91645:e=>{"use strict";e.exports=require("net")},92602:e=>{"use strict";e.exports=import("firebase-admin/messaging")},94735:e=>{"use strict";e.exports=require("events")}};var t=require("../../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[4447,9558,1658,6533,2002,8065,4208,6637,683],()=>r(25380));module.exports=s})();